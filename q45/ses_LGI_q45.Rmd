---
title: "SES_Anat_Analyses"
author: "Lindsay Olson"
date: "2/11/2021"
output: 
  html_document:
    toc: TRUE
#output:
 # pdf_document:
  #    extra_dependencies: ["float"]
---

```{r setup, include=FALSE}

library(float)
library(tidyverse)
library(knitr)
library(ggplot2)
library(knitr)
library(MBESS)
library(dplyr)
library(ppcor)
library(corrplot)
library(Hmisc)
library(dplyr)
library(kableExtra)
#library(pander)
library(sjPlot)
library(sjmisc)
library(sjlabelled)
library(tableone)
library(dplyr)
library(tableone)
library(pander)
library(furniture)
library(knitr)


options(digits = 4, scipen = 999)


knitr::opts_chunk$set(warning=FALSE, message=FALSE, error = FALSE)

```
# Compare Q>=3 and Q>=4 Datasets

```{r, data-readin PrepTableQ4, include=FALSE, echo=FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2_q45.csv')


```
## Participant Table, Q>=4

```{r, PrepareParticipantTable Q>4, include=FALSE, echo=FALSE, warning=FALSE}
# Create a table of some chicken weight summary statistics using dplyr

#library(compareGroups)


tableDataQ4 = anat_data[,c('Dx', 'SEX', 'V1.Age', 'MEL_cat', 'INR', 'zipIncome', 'SES1', 'SES2', 'ExpLang_T', 'RecLang_T', 'ELC_SS', 'TBV')]

listVars <- c("SEX", "V1.Age", "MEL_cat", "INR", "zipIncome", "SES1", "SES2", "ExpLang_T", "RecLang_T", "ELC_SS", "TBV")

catVars <- c("Dx")

table1 <- CreateTableOne(vars = listVars, data = anat_data, factorVars = catVars, strata = c("Dx"))

table_one_matrix <- print(table1,
  includeNA = FALSE,
  showAllLevels = TRUE
)


```


```{r, PrintParticipantTable Q>4, include=TRUE, echo=FALSE, warning=FALSE}

library(pander)


pandoc_table <- pandoc.table(table_one_matrix,
  split.table = Inf,
  style = "rmarkdown",
  caption = "Participant Summary Table for Q>=4") 



```

```{r, data-readin Q3 Bivariate Corr All, include=FALSE, echo=FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2.csv')



```
## Participant Table, Q>=3

```{r, PrepareParticipantTable Q>3, include=FALSE, echo=FALSE, warning=FALSE}
# Create a table of some chicken weight summary statistics using dplyr

#library(compareGroups)


tableDataQ4 = anat_data[,c('Dx', 'SEX', 'V1.Age', 'MEL_cat', 'INR', 'zipIncome', 'SES1', 'SES2', 'ExpLang_T', 'RecLang_T', 'ELC_SS', 'TBV')]

listVars <- c("SEX", "V1.Age", "MEL_cat", "INR", "zipIncome", "SES1", "SES2", "ExpLang_T", "RecLang_T", "ELC_SS", "TBV")

catVars <- c("Dx")

table1 <- CreateTableOne(vars = listVars, data = anat_data, factorVars = catVars, strata = c("Dx"))

table_one_matrix <- print(table1,
  includeNA = FALSE,
  showAllLevels = TRUE
)



```


```{r, PrintParticipantTable Q>3, include=TRUE, echo=FALSE, warning=FALSE}

library(pander)


pandoc_table <- pandoc.table(table_one_matrix,
  split.table = Inf,
  style = "rmarkdown",
  caption = "Participant Summary Table for Q>=3") 



```


```{r, data-readin Q4 Bivariate Corr All, include=FALSE, echo=FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2_q45.csv')

## Recode some Vars
anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)


```

## Bivariate Correlation Plots, ASD&TD Together, Q>=4
```{r corrplots, include=TRUE, echo=FALSE, warning=FALSE,  fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot'}



SES_Lang_LGI <- rcorr(as.matrix(anat_data[,c("dxCoded","V1.Age", "MEL_cat", "INR", "SES1", "SES2", "zipIncome","lh_transversetemporal_lgi", "rh_transversetemporal_lgi", "lh_superiortemporal_lgi", "rh_superiortemporal_lgi", "lh_middletemporal_lgi", "rh_middletemporal_lgi", "lh_parsopercularis_lgi", "rh_parsopercularis_lgi", "lh_parsorbitalis_lgi", "rh_parsorbitalis_lgi", "lh_parstriangularis_lgi", "rh_parstriangularis_lgi", "TBV")], use="pairwise.complete.obs"))

#mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/corrPlots/LGI", "SES_LGI_varsCorr_q45.tiff")
#tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
corrplot(SES_Lang_LGI$r, method = "color",  type = "lower", outline = T, addgrid.col = "darkgray", order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_Lang_LGI$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```



```{r, data-readin-Q3, include=FALSE, echo=FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2.csv')

## Recode some Vars
anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



```

## Bivariate Correlation ASD and TD, Q>=3
```{r corrplotsQ3, include=TRUE, echo=FALSE, warning=FALSE,  fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot'}



SES_Lang_LGI <- rcorr(as.matrix(anat_data[,c("dxCoded", "V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "SES2", "zipIncome","lh_transversetemporal_lgi", "rh_transversetemporal_lgi", "lh_superiortemporal_lgi", "rh_superiortemporal_lgi", "lh_middletemporal_lgi", "rh_middletemporal_lgi", "lh_parsopercularis_lgi", "rh_parsopercularis_lgi", "lh_parsorbitalis_lgi", "rh_parsorbitalis_lgi", "lh_parstriangularis_lgi", "rh_parstriangularis_lgi", "TBV")], use="pairwise.complete.obs"))

#mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/corrPlots/LGI", "SES_LGI_varsCorr_q45.tiff")
#tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
corrplot(SES_Lang_LGI$r, method = "color",  type = "lower", outline = T, addgrid.col = "darkgray", order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_Lang_LGI$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```

```{r, data-readin Q4 Bivariate Corr ASD, include=FALSE, echo=FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2_q45.csv')

## Recode some Vars
anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



```

## Bivariate correlations, ASD Only, Q>=4
```{r corrplots-ASD, include=TRUE, echo=FALSE, warning=FALSE, fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot ASD Only'}


anat_data_ASD <- subset(anat_data, anat_data$Dx == "ASD")

options(digits = 2)
SES_corr_ASD <- rcorr(as.matrix(anat_data_ASD[,c("V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "SES2", "zipIncome","lh_transversetemporal_lgi", "rh_transversetemporal_lgi", "lh_superiortemporal_lgi", "rh_superiortemporal_lgi", "lh_middletemporal_lgi", "rh_middletemporal_lgi", "lh_parsopercularis_lgi", "rh_parsopercularis_lgi", "lh_parsorbitalis_lgi", "rh_parsorbitalis_lgi", "lh_parstriangularis_lgi", "rh_parstriangularis_lgi", "TBV")], use="pairwise.complete.obs"))


corrplot(SES_corr_ASD$r, method = "color",  type = "lower",outline = T, order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_corr_ASD$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```

```{r, data-readin-Q3 ASD Only, include=FALSE, echo=FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2.csv')

## Recode some Vars
anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



```

## Bivariate correlations, ASD Only, Q>=3
```{r corrplots-ASD Q3, include=TRUE, echo=FALSE, warning=FALSE, fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot ASD Only'}


anat_data_ASD <- subset(anat_data, anat_data$Dx == "ASD")

options(digits = 2)
SES_corr_ASD <- rcorr(as.matrix(anat_data_ASD[,c("V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "SES2", "zipIncome","lh_transversetemporal_lgi", "rh_transversetemporal_lgi", "lh_superiortemporal_lgi", "rh_superiortemporal_lgi", "lh_middletemporal_lgi", "rh_middletemporal_lgi", "lh_parsopercularis_lgi", "rh_parsopercularis_lgi", "lh_parsorbitalis_lgi", "rh_parsorbitalis_lgi", "lh_parstriangularis_lgi", "rh_parstriangularis_lgi", "TBV")], use="pairwise.complete.obs"))


corrplot(SES_corr_ASD$r, method = "color",  type = "lower",outline = T, order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_corr_ASD$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```


```{r, data-readin Q4 Bivariate Corr TD, include=FALSE, echo=FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2_q45.csv')

## Recode some Vars
anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



```

## Bivariate correlations, TD Only Q>=4
```{r corrplots-TD, include=TRUE, echo=FALSE, warning=FALSE, fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot, TD Only'}



anat_data_TD <- subset(anat_data, anat_data$Dx == "TD")

options(digits = 2)
SES_corr_TD <- rcorr(as.matrix(anat_data_TD[,c("V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "SES2", "zipIncome","lh_transversetemporal_lgi", "rh_transversetemporal_lgi", "lh_superiortemporal_lgi", "rh_superiortemporal_lgi", "lh_middletemporal_lgi", "rh_middletemporal_lgi", "lh_parsopercularis_lgi", "rh_parsopercularis_lgi", "lh_parsorbitalis_lgi", "rh_parsorbitalis_lgi", "lh_parstriangularis_lgi", "rh_parstriangularis_lgi", "TBV")], use="pairwise.complete.obs"))

#mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/corrPlots/LGI", #"SES_varsCorr_ASD_q45.tiff")
#tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
corrplot(SES_corr_TD$r, method = "color",  type = "lower", outline = T, order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_corr_TD$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()

```


```{r, data-readin-Q3 TD Only, include=FALSE, echo=FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2.csv')

## Recode some Vars
anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



```



## Bivariate correlations, TD Only Q>=3
```{r corrplots-TDQ3, include=TRUE, echo=FALSE, warning=FALSE, fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot, TD Only'}



anat_data_TD <- subset(anat_data, anat_data$Dx == "TD")

options(digits = 2)
SES_corr_TD <- rcorr(as.matrix(anat_data_TD[,c("V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "SES2", "zipIncome","lh_transversetemporal_lgi", "rh_transversetemporal_lgi", "lh_superiortemporal_lgi", "rh_superiortemporal_lgi", "lh_middletemporal_lgi", "rh_middletemporal_lgi", "lh_parsopercularis_lgi", "rh_parsopercularis_lgi", "lh_parsorbitalis_lgi", "rh_parsorbitalis_lgi", "lh_parstriangularis_lgi", "rh_parstriangularis_lgi", "TBV")], use="pairwise.complete.obs"))

#mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/corrPlots/LGI", #"SES_varsCorr_ASD_q45.tiff")
#tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
corrplot(SES_corr_TD$r, method = "color",  type = "lower", outline = T, order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_corr_TD$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```

```{r, data-readin Q4 RegModels, include=FALSE, echo=FALSE, eval = FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2_q45.csv')

## Recode some Vars
anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



```

# LGI Results, compare results for data quality Q>=4 vs. data quality Q>=3, Regression Models: INR

```{r, regTables, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}

### Iterate through reg models. Can suppress output in html file or include it if desired. 

set.seed(1)

# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 14
outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)

anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)


#coVars <- anat_data[,c(4:6, 36)]

#sesVars <- anat_data[,c(37:39, 41:42)]


## INR Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ anat_data$INR + anat_data$TBV +anat_data$sexCoded)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Income:Needs", "TBV", "Sex"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```



```{r, data-readin-Q3 RegModels, include=FALSE, echo=FALSE, eval = FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2.csv')

## Recode some Vars
anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



```


```{r, regTablesQ3, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}
set.seed(1)

# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 14
outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)

anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)


#coVars <- anat_data[,c(4:6, 36)]

#sesVars <- anat_data[,c(37:39, 41:42)]


## INR Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ anat_data$INR + anat_data$TBV +anat_data$V1.Age)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Income:Needs", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```


## INR Results Q>=4

```{r, data-readin Q4 INR Results, include=FALSE, echo=FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2_q45.csv')

## Recode some Vars
anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



```


```{r, INR Plots and tables, echo = FALSE, include=TRUE, results= 'asis'}
outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)



cat("\n")
cat("\n")
cat("\n")
cat("\n")
    
lm2 <- lm(rh_parsopercularis_lgi ~  INR + TBV + V1.Age, data=anat_data, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Income:Needs", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[10]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(anat_data, aes(x=INR, y=rh_parsopercularis_lgi, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('RH Pars Opercularis LGI') +
    xlab('Income:Needs Ratio') +
    theme_classic()

```

Income to needs ratio predicts rh_parsopercularis_lgi, controlling for age and TBV (dx, sex, and age not sig. predictors)


## INR Results Q>3

```{r, data-readin-Q3 INR, include=FALSE, echo=FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2.csv')

## Recode some Vars
anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



```


```{r, INR Plots and tables Q3, echo = FALSE, include=TRUE, results= 'asis'}
outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

    
lm2 <- lm(rh_parsopercularis_lgi ~  INR + TBV + V1.Age, data=anat_data, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Income:Needs", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[10]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(anat_data, aes(x=INR, y=rh_parsopercularis_lgi, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('RH Pars Opercularis LGI') +
    xlab('Income:Needs Ratio') +
    theme_classic()

```

Income to needs ratio predicts **rh_parsopercularis_lgi**, controlling for age and TBV (dx, sex, and age not sig. predictors)




# LGI Results, compare restuls for data quality Q>=4 vs. data quality Q>=3, Regression Models SES1


## Neighborhood Advantage Results Q>=4

```{r, data-readin Q4 SES1 Results, include=FALSE, echo=FALSE, eval = FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2_q45.csv')

## Recode some Vars
anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



```
  
```{r, SES1 Models Q4, echo=FALSE, include=FALSE, eval = FALSE, results= 'asis'}
set.seed(1)

n <- 14
outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)

anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ anat_data$SES1 + anat_data$TBV + anat_data$V1.Age)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "SES1", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```

Neighborhood Advantage **not** a significant predictor of LGI when controlling for TBV and dx for Q>=4.

```{r, data-readin-Q3 RegModels SES1, include=FALSE, echo=FALSE, eval = FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2.csv')

## Recode some Vars
anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



```

## Neighborhood Advantage Results Q>3
  
```{r, SES1 Models Q3, echo=FALSE, include=FALSE, eval = FALSE, results= 'asis'}
set.seed(1)

n <- 14
outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)

anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ anat_data$SES1 + anat_data$TBV + anat_data$V1.Age)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "SES1", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```

Neighborhood Advantage **not** a significant predictor of LGI when controlling for TBV and dx for data Q>=3.



# LGI Results, compare restuls for data quality Q>=4 vs. data quality Q>=3, Regression Models SES2

## Neighborhood Disadvantage Results Q>=4

```{r, data-readin Q4 SES2 Results, include=FALSE, echo=FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2_q45.csv')

## Recode some Vars
anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



```
  
```{r, SES2 Models Q4, echo=FALSE, include=FALSE, eval=FALSE, results= 'asis'}
set.seed(1)

n <- 14
outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)

anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



## SES2 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ anat_data$SES2 + anat_data$TBV + anat_data$V1.Age)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "SES2", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```

Neighborhood Disdvantage *is* a significant predictor of **lh-middle temporal LGI** and **rh-transverse temporal** when controlling for TBV and age for Q>=4. There is *not* a significant SES2xDx Interaction (dx main effect also not significant). This indicates that higher *disadvantage* is associated with higher LGI (primarily in the TD group). This finding is in a different direction than those with INR. 


```{r, SES2 Plots and tables Q4, echo = FALSE, include=TRUE, results= 'asis'}
outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)

anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



cat("\n")
cat("\n")
cat("\n")
cat("\n")

    
lm2 <- lm(lh_middletemporal_lgi ~  SES2 + TBV + V1.Age, data=anat_data, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "SES2", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[3]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(anat_data, aes(x=SES2, y=lh_middletemporal_lgi, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Middle Temporal LGI') +
    xlab('Neighborhood Disadvantage') +
    theme_classic()

```


## Neighborhood Disadvantage Results Q>=3




```{r, data-readin-Q3 RegModels SES2, include=TRUE, echo=FALSE, eval= TRUE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2.csv')

## Recode some Vars
anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



```



```{r, SES2 Models Q3, echo=FALSE, include=TRUE, eval = FALSE, results= 'asis'}
set.seed(1)

n <- 14
outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)

anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



## SES2 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ anat_data$SES2 + anat_data$TBV + anat_data$V1.Age)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "SES2", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```


Neighborhood Disadvantage is *not* a significant predictor of LGI when controlling for TBV and dx for data q >=3.

```{r, SES2 Plots and tables Q3, echo = FALSE, include=TRUE, results= 'asis'}
outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

    
lm2 <- lm(lh_middletemporal_lgi ~  SES2 + TBV + V1.Age, data=anat_data, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "SES2", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[3]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(anat_data, aes(x=SES2, y=lh_middletemporal_lgi, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Middle Temporal LGI') +
    xlab('Neighborhood Disadvantage') +
    theme_classic()

```


# LGI Results, compare results for data quality Q>=4 vs. data quality Q>=3, Regression Models MEL

## MEL Results Q>=4

```{r, data-readin Q4 MEL Results, include=FALSE, echo=FALSE, eval = FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2_q45.csv')

## Recode some Vars
anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



```
  

```{r, MEL Models Q4, echo=FALSE, include=FALSE, eval = FALSE, results= 'asis'}
set.seed(1)

# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 14
outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)

anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ anat_data$MEL_cat + anat_data$TBV + anat_data$V1.Age)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "MEL", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```


Maternal Education **not** a significant predictor of LGI when controlling for TBV and dx for data Q>=4. 



```{r, data-readin-Q3 RegModels MEL, include=TRUE, echo=FALSE, eval = FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2.csv')

## Recode some Vars
anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



```


## MEL Results Q>=3

```{r, MEL Models Q3, echo=FALSE, include=FALSE, eval = FALSE, results= 'asis'}
set.seed(1)

n <- 14
outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)

anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ anat_data$MEL_cat + anat_data$TBV + anat_data$V1.Age)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "MEL", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```


Maternal Education **not** a significant predictor of LGI when controlling for TBV and dx for data Q>=3. 


# LGI Results, compare restuls for data quality Q>=4 vs. data quality Q>=3, Regression Models ZipIncome


## Zip-Income Results, data Q>=4

```{r, data-readin Q4 ZipIncome Results, include=FALSE, echo=FALSE, eval = FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2_q45.csv')

## Recode some Vars
anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)



```

```{r, ZipIncome Models, echo=FALSE, include=TRUE, eval=FALSE, results= 'asis'}
set.seed(1)

n <- 14
outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)

anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)


## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ anat_data$zipIncome + anat_data$TBV + anat_data$V1.Age) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Zip-Income", "TBV", "Sex"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```

Zip-Income **is a significant predictor** when controlling for TBV. Removed Age and Dx from models since they were not significant. 
```{r, ZipIncome Plots and tables Q4, echo = FALSE, include=TRUE, results= 'asis'}
outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

    
lm2 <- lm(lh_parsorbitalis_lgi ~  zipIncome + TBV + V1.Age, data=anat_data, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Zip-Income", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[11]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(anat_data, aes(x=zipIncome, y=lh_parsorbitalis_lgi, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Pars Orbitalis LGI') +
    xlab('Zip-Income') +
    theme_classic()

```




```{r, data-readin-Q3 RegModels ZipIncome, include=FALSE, echo=FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2.csv')

anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)

```


## Zip-Income Results Q>=3

```{r, ZipIncome Models Q3, echo=FALSE, include=TRUE, eval=FALSE, results= 'asis'}
set.seed(1)

n <- 14
outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)

anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)


## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ anat_data$zipIncome + anat_data$TBV + anat_data$V1.Age)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Zip-Income", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```


Zip-Income **is** a significant predictor of **lh-pars orbitals LGI**, when controlling for TBV and age, for Q>=3. 

```{r, ZipIncome Plots and tables Q3, echo = FALSE, include=TRUE, results= 'asis'}
outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

rm(lm2)
    
lm2 <- lm(lh_parsorbitalis_lgi ~  zipIncome + TBV + V1.Age, data=anat_data, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Zip-Income", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[11]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(anat_data, aes(x=zipIncome, y=lh_parsorbitalis_lgi, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Pars Orbitalis LGI') +
    xlab('Zip-Income') +
    theme_classic()

```


# LGI Results, compare results for data quality Q>=4 vs. data quality Q>=3, Regression Models: Dx

```{r, data-readin-Q4 RegModels Dx, include=TRUE, echo=FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2_q45.csv')

anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)

```



```{r, Dx Models Q4, echo=FALSE, include=FALSE, eval=FALSE, results= 'asis'}
set.seed(1)

n <- 14
outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)


## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ anat_data$dxCoded + anat_data$TBV + anat_data$V1.Age + anat_data$sexCoded)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Dx", "TBV", "Age", "Sex"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```
## Dx Results, Q>=4

Dx predicts **left hemisphere pars triangularis and right hemisphere middle temporal LGI**, when controlling for TBV, age, and sex (the latter were not sig. predictors or RH MTG LGI, so removed from the model). 


```{r, Dx Plots and tables Q4, echo = FALSE, include=TRUE, eval=TRUE, results= 'asis'}
outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

     lm2 <- lm(lh_parstriangularis_lgi ~  dxCoded + TBV + sexCoded, data=anat_data, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Dx", "TBV", "Sex"),
  dv.labels = paste(outcomeVars[[13]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(anat_data, aes(x=Dx, y=lh_parstriangularis_lgi, color=Dx)) + 
    geom_boxplot() +
    theme(text = element_text(size = 20)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Pars Triangularis LGI') +
    xlab('Diagnosis') +
    theme_classic()
    
    lm2 <- lm(rh_middletemporal_lgi ~  dxCoded + TBV, data=anat_data, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Dx", "TBV"),
  dv.labels = paste(outcomeVars[[4]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(anat_data, aes(x=Dx, y=rh_middletemporal_lgi, color=Dx)) + 
    geom_boxplot() +
    theme(text = element_text(size = 20)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('RH Middle Temporal LGI') +
    xlab('Diagnosis') +
    theme_classic()
    
   
    
    

```



```{r, data-readin-Q3 RegModels Dx, include=FALSE, eval=FALSE, echo=FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2.csv')

```



```{r, Dx Models Q3, echo=FALSE, include=FALSE, eval=FALSE, results= 'asis'}
set.seed(1)

n <- 14
outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)

anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)


## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ anat_data$dxCoded + anat_data$TBV + anat_data$V1.Age +anat_data$sexCoded)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Dx", "TBV", "Age", "Sex"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```

## Dx Results, Q>=3
Diagnosis not associated with LGI in the Q>=3 dataset (after removing SES variables from the model).

```{r, Dx Plots and tables Q3, echo = FALSE, include=TRUE, eval=TRUE, results= 'asis'}
outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)


anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)

outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

     lm2 <- lm(lh_parstriangularis_lgi ~  dxCoded + TBV + sexCoded, data=anat_data, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Dx", "TBV", "Sex"),
  dv.labels = paste(outcomeVars[[13]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(anat_data, aes(x=Dx, y=lh_parstriangularis_lgi, color=Dx)) + 
    geom_boxplot() +
    theme(text = element_text(size = 20)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Pars Triangularis LGI') +
    xlab('Diagnosis') +
    theme_classic()
    
    lm2 <- lm(rh_middletemporal_lgi ~  dxCoded + TBV, data=anat_data, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Dx", "TBV"),
  dv.labels = paste(outcomeVars[[4]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(anat_data, aes(x=Dx, y=rh_middletemporal_lgi, color=Dx)) + 
    geom_boxplot() +
    theme(text = element_text(size = 20)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('RH Middle Temporal LGI') +
    xlab('Diagnosis') +
    theme_classic()
    
    

```



# LGI Results, compare results for data quality Q>=4 vs. data quality Q>=3, Regression Models: Sex/Gender

## Sex/Gender Results, Q>=4

```{r, data-readin-Q4 RegModels Sex/Gender, include=TRUE, echo=FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2_q45.csv')

```
Sex predicts **lh pars opercularis LGI**, controlling for TBV, dx, and age

```{r, Sex Models Q4, echo=FALSE, include=FALSE, results= 'asis'}
set.seed(1)

n <- 14
outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)

anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)


## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ anat_data$sexCoded + anat_data$TBV + anat_data$V1.Age +anat_data$dxCoded)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Sex", "TBV", "Age", "Dx"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```


```{r, SexEffectsQ4, echo=FALSE, include=TRUE, results= 'asis'}

       rm(lm2)
lm2 <- lm(lh_parsopercularis_lgi ~  sexCoded + dxCoded + V1.Age + TBV, data=anat_data, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Sex", "Dx", "Age", "TBV"),
  dv.labels = paste(outcomeVars[[9]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")

ggplot(anat_data, aes(x=SEX, y=lh_parsopercularis_lgi, color=SEX)) + 
  geom_boxplot() +
  theme(text = element_text(size = 20)) +
  scale_color_manual(values=c("purple","blue")) +
  scale_fill_manual(values=c("purple","blue")) +
  ylab('LH Pars Opercularis LGI') +
  xlab('Sex/Gender') +
  theme_classic()
```


## Sex Results Q>=3
Sex predicts **lh pars opercularis LGI**, controlling for TBV, dx,  and age

```{r, data-readin-Q3 RegModels Sex, include=TRUE, echo=FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2.csv')


anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)

```



```{r, Sex Models Q3, echo=FALSE, include=FALSE, eval=FALSE, results= 'asis'}
set.seed(1)

n <- 14
outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)

anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
 
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)


## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ anat_data$sexCoded + anat_data$TBV + anat_data$V1.Age +anat_data$dxCoded)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Sex", "TBV", "Age", "Dx"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```



```{r, SexEffectsQ3, echo=FALSE, include=TRUE, results= 'asis'}


outcomes <- anat_data[,c(7:20)]
outcomeVars = names(outcomes)
       rm(lm2)
lm2 <- lm(lh_parsopercularis_lgi ~  sexCoded + dxCoded + V1.Age + TBV, data=anat_data, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Sex", "Dx", "Age", "TBV"),
  dv.labels = paste(outcomeVars[[9]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")

ggplot(anat_data, aes(x=SEX, y=lh_parsopercularis_lgi, color=SEX)) + 
  geom_boxplot() +
  theme(text = element_text(size = 20)) +
  scale_color_manual(values=c("purple","blue")) +
  scale_fill_manual(values=c("purple","blue")) +
  ylab('LH Pars Opercularis LGI') +
  xlab('Sex/Gender') +
  theme_classic()
```


