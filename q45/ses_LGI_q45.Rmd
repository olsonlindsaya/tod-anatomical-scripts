---
title: "SES_Anat_Analyses"
author: "Lindsay Olson"
date: "2/11/2021"
output: 
  html_document:
    toc: TRUE
#output:
 # pdf_document:
  #    extra_dependencies: ["float"]
---

```{r setup, include=FALSE}

library(float)
library(tidyverse)
library(knitr)
library(ggplot2)
library(knitr)
library(MBESS)
library(dplyr)
library(ppcor)
library(corrplot)
library(Hmisc)
library(dplyr)
library(kableExtra)
library(pander)
library(sjPlot)
library(sjmisc)
library(sjlabelled)
library(tableone)
library(dplyr)
library(tableone)
library(pander)
library(furniture)
library(knitr)


options(digits = 4, scipen = 999)


knitr::opts_chunk$set(warning=FALSE, message=FALSE, error = FALSE)

```


```{r, data-readin PrepTableQ4, include=FALSE, echo=FALSE, warning=FALSE}

# Read in dataset

#LGI Data 
rm(list=ls()) ## clear the workspace
#dev.off() ## Clear the plots


LGI_data_q4 = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2_q45.csv')

LGI_data_q4$dxCoded <- as.factor(LGI_data_q4$Dx) # 1 = ASD, 2 = TD
LGI_data_q4$dxCoded <-unclass(LGI_data_q4$dxCoded)
 
LGI_data_q4$sexCoded <- as.factor(LGI_data_q4$SEX) # 1 = Female, 2 = Male
LGI_data_q4$sexCoded <-unclass(LGI_data_q4$sexCoded)

LGI_data_q3 = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SES_Anat_v2.csv')

LGI_data_q3$dxCoded <- as.factor(LGI_data_q3$Dx) # 1 = ASD, 2 = TD
LGI_data_q3$dxCoded <-unclass(LGI_data_q3$dxCoded)
 
LGI_data_q3$sexCoded <- as.factor(LGI_data_q3$SEX) # 1 = Female, 2 = Male
LGI_data_q3$sexCoded <-unclass(LGI_data_q3$sexCoded)


CT_data_q3 = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/Lang_CT_SES.csv')

CT_data_q3$dxCoded <- as.factor(CT_data_q3$Dx) # 1 = ASD, 2 = TD
CT_data_q3$dxCoded <-unclass(CT_data_q3$dxCoded)
 
CT_data_q3$sexCoded <- as.factor(CT_data_q3$SEX) # 1 = Female, 2 = Male
CT_data_q3$sexCoded <-unclass(CT_data_q3$sexCoded)

CT_data_q4 = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/Lang_CT_SES_q45.csv')


CT_data_q4$dxCoded <- as.factor(CT_data_q4$Dx) # 1 = ASD, 2 = TD
CT_data_q4$dxCoded <-unclass(CT_data_q4$dxCoded)
 
CT_data_q4$sexCoded <- as.factor(CT_data_q4$SEX) # 1 = Female, 2 = Male
CT_data_q4$sexCoded <-unclass(CT_data_q4$sexCoded)


SA_data_q3 = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SA_SES.csv')

SA_data_q3$dxCoded <- as.factor(SA_data_q3$Dx) # 1 = ASD, 2 = TD
SA_data_q3$dxCoded <-unclass(SA_data_q3$dxCoded)
 
SA_data_q3$sexCoded <- as.factor(SA_data_q3$SEX) # 1 = Female, 2 = Male
SA_data_q3$sexCoded <-unclass(SA_data_q3$sexCoded)

SA_data_q4 = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/tod-anatomical-scripts/q45/SA_SES_q45.csv')


SA_data_q4$dxCoded <- as.factor(SA_data_q4$Dx) # 1 = ASD, 2 = TD
SA_data_q4$dxCoded <-unclass(SA_data_q4$dxCoded)
 
SA_data_q4$sexCoded <- as.factor(SA_data_q4$SEX) # 1 = Female, 2 = Male
SA_data_q4$sexCoded <-unclass(SA_data_q4$sexCoded)


```
# Compare Q>=3 and Q>=4 Datasets: Participant Characteristics

### Participant Table, Q>=4

```{r, PrepareParticipantTable Q>4, include=FALSE, echo=FALSE, warning=FALSE}
# Create a table of some chicken weight summary statistics using dplyr

#library(compareGroups)


tableDataQ4 = LGI_data_q4[,c('Dx', 'SEX', 'V1.Age', 'MEL_cat', 'INR', 'zipIncome', 'SES1', 'ExpLang_T', 'RecLang_T', 'ELC_SS', 'TBV')]

listVars <- c("SEX", "V1.Age", "MEL_cat", "INR", "zipIncome", "SES1", "ExpLang_T", "RecLang_T", "ELC_SS", "TBV")

catVars <- c("Dx")

table1 <- CreateTableOne(vars = listVars, data = LGI_data_q4, factorVars = catVars, strata = c("Dx"))

table_one_matrix <- print(table1,
  includeNA = FALSE,
  showAllLevels = TRUE
)



```


```{r, PrintParticipantTable Q>4, include=TRUE, echo=FALSE, warning=FALSE}




pandoc_table <- pandoc.table(table_one_matrix,
  split.table = Inf,
  style = "rmarkdown",
  caption = "Participant Summary Table for Q>=4") 



```


### Participant Table, Q>=3

```{r, PrepareParticipantTable Q>3, include=FALSE, echo=FALSE, warning=FALSE}
# Create a table of some chicken weight summary statistics using dplyr

#library(compareGroups)

rm(table_one_matrix)

tableDataQ3 = LGI_data_q3[,c('Dx', 'SEX', 'V1.Age', 'MEL_cat', 'INR', 'zipIncome', 'SES1', 'ExpLang_T', 'RecLang_T', 'ELC_SS', 'TBV')]

listVars <- c("SEX", "V1.Age", "MEL_cat", "INR", "zipIncome", "SES1", "ExpLang_T", "RecLang_T", "ELC_SS", "TBV")

catVars <- c("Dx")

table1 <- CreateTableOne(vars = listVars, data = LGI_data_q3, factorVars = catVars, strata = c("Dx"))

table_one_matrix <- print(table1,
  includeNA = FALSE,
  showAllLevels = TRUE
)



```


```{r, PrintParticipantTable Q>3, include=TRUE, echo=FALSE, warning=FALSE}



pandoc_table <- pandoc.table(table_one_matrix,
  split.table = Inf,
  style = "rmarkdown",
  caption = "Participant Summary Table for Q>=3") 



```

# LGI Results, Bivariate Correlations

### Bivariate Correlation Plots, ASD&TD Together, Q>=4
```{r corrplots, include=TRUE, echo=FALSE, warning=FALSE,  fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot'}




SES_Lang_LGI <- rcorr(as.matrix(LGI_data_q4[,c("dxCoded","V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "zipIncome","lh_transversetemporal_lgi", "rh_transversetemporal_lgi", "lh_superiortemporal_lgi", "rh_superiortemporal_lgi", "lh_middletemporal_lgi", "rh_middletemporal_lgi", "lh_parsopercularis_lgi", "rh_parsopercularis_lgi", "lh_parsorbitalis_lgi", "rh_parsorbitalis_lgi", "lh_parstriangularis_lgi", "rh_parstriangularis_lgi", "TBV")], use="pairwise.complete.obs"))

#mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/corrPlots/LGI", "SES_LGI_varsCorr_q45.tiff")
#tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
corrplot(SES_Lang_LGI$r, method = "color",  type = "lower", outline = T, addgrid.col = "darkgray", order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_Lang_LGI$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```


### Bivariate Correlation ASD and TD, Q>=3
```{r corrplotsQ3, include=TRUE, echo=FALSE, warning=FALSE,  fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot'}

rm(SES_Lang_LGI)

SES_Lang_LGI <- rcorr(as.matrix(LGI_data_q3[,c("dxCoded", "V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "zipIncome","lh_transversetemporal_lgi", "rh_transversetemporal_lgi", "lh_superiortemporal_lgi", "rh_superiortemporal_lgi", "lh_middletemporal_lgi", "rh_middletemporal_lgi", "lh_parsopercularis_lgi", "rh_parsopercularis_lgi", "lh_parsorbitalis_lgi", "rh_parsorbitalis_lgi", "lh_parstriangularis_lgi", "rh_parstriangularis_lgi", "TBV")], use="pairwise.complete.obs"))

#mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/corrPlots/LGI", "SES_LGI_varsCorr_q45.tiff")
#tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
corrplot(SES_Lang_LGI$r, method = "color",  type = "lower", outline = T, addgrid.col = "darkgray", order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_Lang_LGI$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```


### Bivariate correlations, ASD Only, Q>=4
```{r corrplots-ASD, include=TRUE, echo=FALSE, warning=FALSE, fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot ASD Only'}



LGI_data_q4_ASD <- subset(LGI_data_q4, LGI_data_q4$Dx == "ASD")

options(digits = 2)
SES_corr_ASD <- rcorr(as.matrix(LGI_data_q4_ASD[,c("V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "zipIncome","lh_transversetemporal_lgi", "rh_transversetemporal_lgi", "lh_superiortemporal_lgi", "rh_superiortemporal_lgi", "lh_middletemporal_lgi", "rh_middletemporal_lgi", "lh_parsopercularis_lgi", "rh_parsopercularis_lgi", "lh_parsorbitalis_lgi", "rh_parsorbitalis_lgi", "lh_parstriangularis_lgi", "rh_parstriangularis_lgi", "TBV")], use="pairwise.complete.obs"))


corrplot(SES_corr_ASD$r, method = "color",  type = "lower",outline = T, order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_corr_ASD$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```


### Bivariate correlations, ASD Only, Q>=3
```{r corrplots-ASD Q3, include=TRUE, echo=FALSE, warning=FALSE, fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot ASD Only'}

rm(SES_corr_ASD)

LGI_data_q3_ASD <- subset(LGI_data_q3, LGI_data_q3$Dx == "ASD")

options(digits = 2)
SES_corr_ASD <- rcorr(as.matrix(LGI_data_q3_ASD[,c("V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "zipIncome","lh_transversetemporal_lgi", "rh_transversetemporal_lgi", "lh_superiortemporal_lgi", "rh_superiortemporal_lgi", "lh_middletemporal_lgi", "rh_middletemporal_lgi", "lh_parsopercularis_lgi", "rh_parsopercularis_lgi", "lh_parsorbitalis_lgi", "rh_parsorbitalis_lgi", "lh_parstriangularis_lgi", "rh_parstriangularis_lgi", "TBV")], use="pairwise.complete.obs"))


corrplot(SES_corr_ASD$r, method = "color",  type = "lower",outline = T, order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_corr_ASD$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```



### Bivariate correlations, TD Only Q>=4
```{r corrplots-TD, include=TRUE, echo=FALSE, warning=FALSE, fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot, TD Only'}


LGI_data_q4_TD <- subset(LGI_data_q4, LGI_data_q4$Dx == "TD")

options(digits = 2)
SES_corr_TD <- rcorr(as.matrix(LGI_data_q4_TD[,c("V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "zipIncome","lh_transversetemporal_lgi", "rh_transversetemporal_lgi", "lh_superiortemporal_lgi", "rh_superiortemporal_lgi", "lh_middletemporal_lgi", "rh_middletemporal_lgi", "lh_parsopercularis_lgi", "rh_parsopercularis_lgi", "lh_parsorbitalis_lgi", "rh_parsorbitalis_lgi", "lh_parstriangularis_lgi", "rh_parstriangularis_lgi", "TBV")], use="pairwise.complete.obs"))

#mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/corrPlots/LGI", #"SES_varsCorr_ASD_q45.tiff")
#tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
corrplot(SES_corr_TD$r, method = "color",  type = "lower", outline = T, order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_corr_TD$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()

```




### Bivariate correlations, TD Only Q>=3
```{r corrplots-TDQ3, include=TRUE, echo=FALSE, warning=FALSE, fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot, TD Only'}

rm(SES_corr_TD)

LGI_data_q3_TD <- subset(LGI_data_q3, LGI_data_q3$Dx == "TD")

options(digits = 2)
SES_corr_TD <- rcorr(as.matrix(LGI_data_q3_TD[,c("V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "zipIncome","lh_transversetemporal_lgi", "rh_transversetemporal_lgi", "lh_superiortemporal_lgi", "rh_superiortemporal_lgi", "lh_middletemporal_lgi", "rh_middletemporal_lgi", "lh_parsopercularis_lgi", "rh_parsopercularis_lgi", "lh_parsorbitalis_lgi", "rh_parsorbitalis_lgi", "lh_parstriangularis_lgi", "rh_parstriangularis_lgi", "TBV")], use="pairwise.complete.obs"))

#mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/corrPlots/LGI", #"SES_varsCorr_ASD_q45.tiff")
#tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
corrplot(SES_corr_TD$r, method = "color",  type = "lower", outline = T, order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_corr_TD$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```


# LGI Results, compare results for data quality Q>=4 vs. data quality Q>=3, Regression Models: INR

```{r, regTables INR Q4, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}


set.seed(1)

# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 14
outcomes <- LGI_data_q4[,c(7:20)]
outcomeVars = names(outcomes)



#coVars <- LGI_data_q4[,c(4:6, 36)]

#sesVars <- LGI_data_q4[,c(37:39, 41:42)]


## INR Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ LGI_data_q4$INR + LGI_data_q4$TBV +LGI_data_q4$sexCoded)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Income:Needs", "TBV", "Sex"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```




```{r, regTablesQ3, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}


rm(outcomes)
set.seed(1)

# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 14
outcomes <- LGI_data_q3[,c(7:20)]
outcomeVars = names(outcomes)

#coVars <- LGI_data_q4[,c(4:6, 36)]
#sesVars <- LGI_data_q4[,c(37:39, 41:42)]


## INR Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ LGI_data_q3$INR + LGI_data_q3$TBV +LGI_data_q3$V1.Age)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Income:Needs", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```


### INR Results Q>=4



```{r, INR Plots and tables Q4, echo = FALSE, include=TRUE, results= 'asis'}
#LGI Data 

outcomes <- LGI_data_q4[,c(7:20)]
outcomeVars = names(outcomes)



cat("\n")
cat("\n")
cat("\n")
cat("\n")
    
lm2 <- lm(rh_parsopercularis_lgi ~  INR + TBV + V1.Age, data=LGI_data_q4, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Income:Needs", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[10]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(LGI_data_q4, aes(x=INR, y=rh_parsopercularis_lgi, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('RH Pars Opercularis LGI') +
    xlab('Income:Needs Ratio') +
    theme_classic()

```

* Income to needs ratio predicts rh_parsopercularis_lgi, controlling for age and TBV (dx, sex, and age not sig. predictors), in the Q>=4 dataset.


### INR Results Q>3



```{r, INR Plots and tables Q3, echo = FALSE, include=TRUE, results= 'asis'}

rm(outcomes)

outcomes <- LGI_data_q3[,c(7:20)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

    
lm2 <- lm(rh_parsopercularis_lgi ~  INR + TBV + V1.Age, data=LGI_data_q3, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Income:Needs", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[10]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(LGI_data_q3, aes(x=INR, y=rh_parsopercularis_lgi, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('RH Pars Opercularis LGI') +
    xlab('Income:Needs Ratio') +
    theme_classic()

```

* Income to needs ratio predicts **rh_parsopercularis_lgi**, controlling for age and TBV (dx, sex, and age not sig. predictors), in the Q>=3 dataset. 




# LGI Results, compare results for data quality Q>=4 vs. data quality Q>=3, Regression Models SES1


### Neighborhood Advantage Results Q>=4


  
```{r, SES1 Models Q4, echo=FALSE, include=FALSE, eval = FALSE, results= 'asis'}


set.seed(1)

n <- 14
outcomes <- LGI_data_q4[,c(7:20)]
outcomeVars = names(outcomes)


## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ LGI_data_q4$SES1 + LGI_data_q4$TBV + LGI_data_q4$V1.Age)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "SES1", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```

* Neighborhood Advantage **not** a significant predictor of LGI when controlling for TBV and dx for Q>=4.


### Neighborhood Advantage Results Q>3
  
```{r, SES1 Models Q3, echo=FALSE, include=FALSE, eval = FALSE, results= 'asis'}

rm(outcomes)
set.seed(1)

n <- 14
outcomes <- LGI_data_q3[,c(7:20)]
outcomeVars = names(outcomes)


## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ LGI_data_q3$SES1 + LGI_data_q3$TBV + LGI_data_q3$V1.Age)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "SES1", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```

* Neighborhood Advantage **not** a significant predictor of LGI when controlling for TBV and dx for data Q>=3.



  
```{r, SES2 Models Q4, echo=FALSE, include=FALSE, eval=FALSE, results= 'asis'}

# Read in dataset

#LGI Data 
rm(outcomes)
set.seed(1)

n <- 14
outcomes <- LGI_data_q4[,c(7:20)]
outcomeVars = names(outcomes)



## SES2 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ LGI_data_q4$SES2 + LGI_data_q4$TBV + LGI_data_q4$V1.Age)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "SES2", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }

#Neighborhood Disdvantage *is* a significant predictor of **lh-middle temporal LGI** and **rh-transverse temporal** when controlling for TBV and age for Q>=4. There is *not* a significant SES2xDx Interaction (dx main effect also not significant). This indicates that higher *disadvantage* is associated with higher LGI (primarily in the TD group). This finding is in a different direction than those with INR. 


```




```{r, SES2 Plots and tables Q4, echo = FALSE, include=FALSE, eval=FALSE, results= 'asis'}

rm(outcomes)
outcomes <- LGI_data_q4[,c(7:20)]
outcomeVars = names(outcomes)


cat("\n")
cat("\n")
cat("\n")
cat("\n")

    
lm2 <- lm(lh_middletemporal_lgi ~  SES2 + TBV + V1.Age, data=LGI_data_q4, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "SES2", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[3]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(LGI_data_q4, aes(x=SES2, y=lh_middletemporal_lgi, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Middle Temporal LGI') +
    xlab('Neighborhood Disadvantage') +
    theme_classic()

```




```{r, SES2 Models Q3, echo=FALSE, include=FALSE, eval = FALSE, results= 'asis'}

rm(outcomes)

set.seed(1)

n <- 14
outcomes <- LGI_data_q3[,c(7:20)]
outcomeVars = names(outcomes)



## SES2 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ LGI_data_q3$SES2 + LGI_data_q3$TBV + LGI_data_q3$V1.Age)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "SES2", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }

#Neighborhood Disadvantage is *not* a significant predictor of LGI when controlling for TBV and dx for data q >=3.
```




```{r, SES2 Plots and tables Q3, echo = FALSE, include=FALSE, eval=FALSE, results= 'asis'}


outcomes <- LGI_data_q3[,c(7:20)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

    
lm2 <- lm(lh_middletemporal_lgi ~  SES2 + TBV + V1.Age, data=LGI_data_q3, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "SES2", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[3]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(LGI_data_q3, aes(x=SES2, y=lh_middletemporal_lgi, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Middle Temporal LGI') +
    xlab('Neighborhood Disadvantage') +
    theme_classic()

```


# LGI Results, compare results for data quality Q>=4 vs. data quality Q>=3, Regression Models: MEL

### MEL Results Q>=4

  

```{r, MEL Models Q4, echo=FALSE, include=FALSE, eval = FALSE, results= 'asis'}

rm(outcomes)
set.seed(1)

# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 14
outcomes <- LGI_data_q4[,c(7:20)]
outcomeVars = names(outcomes)


## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ LGI_data_q4$MEL_cat + LGI_data_q4$TBV + LGI_data_q4$V1.Age)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "MEL", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```


* Maternal Education **not** a significant predictor of LGI when controlling for TBV and dx for data Q>=4. 




### MEL Results Q>=3

```{r, MEL Models Q3, echo=FALSE, include=FALSE, eval = FALSE, results= 'asis'}

# Read in dataset

rm(outcomes)

set.seed(1)

n <- 14
outcomes <- LGI_data_q3[,c(7:20)]
outcomeVars = names(outcomes)




## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ LGI_data_q3$MEL_cat + LGI_data_q3$TBV + LGI_data_q3$V1.Age)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "MEL", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```


* Maternal Education **not** a significant predictor of LGI when controlling for TBV and dx for data Q>=3. 


# LGI Results, compare results for data quality Q>=4 vs. data quality Q>=3, Regression Models ZipIncome


### Zip-Income Results, data Q>=4



```{r, ZipIncome Models Q4, echo=FALSE, include=TRUE, eval=FALSE, results= 'asis'}

# Read in dataset

rm(outcomes)

set.seed(1)

n <- 14
outcomes <- LGI_data_q4[,c(7:20)]
outcomeVars = names(outcomes)


## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ LGI_data_q4$zipIncome + LGI_data_q4$TBV + LGI_data_q4$V1.Age)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Zip-Income", "TBV", "Sex"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```

* Zip-Income **is a significant predictor or lh pars orbitalis LGI** when controlling for age (removed TBV because it was not a significant predictor in the model with age and Zip-Income). 


* Dx not a significant predictor in this model, nor is the diagnosisXzipIncome interaction term. 



```{r, ZipIncome Plots and tables Q4, echo = FALSE, include=TRUE, results= 'asis'}

rm(outcomes)

outcomes <- LGI_data_q4[,c(7:20)]
outcomeVars = names(outcomes)



cat("\n")
cat("\n")
cat("\n")
cat("\n")

    
lm2 <- lm(lh_parsorbitalis_lgi ~  zipIncome+V1.Age, data=LGI_data_q4, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Zip-Income", "Age"),
  dv.labels = paste(outcomeVars[[11]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(LGI_data_q4, aes(x=zipIncome, y=lh_parsorbitalis_lgi, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Pars Orbitalis LGI') +
    xlab('Zip-Income') +
    theme_classic()

```



### Zip-Income Results Q>=3

```{r, ZipIncome Models Q3, echo=FALSE, include=FALSE, eval=FALSE, results= 'asis'}


rm(outcomes)
set.seed(1)
n <- 14
outcomes <- LGI_data_q3[,c(7:20)]
outcomeVars = names(outcomes)



## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ LGI_data_q3$zipIncome + LGI_data_q3$TBV + LGI_data_q3$V1.Age)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Zip-Income", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```


* Zip-Income a significant predictor of **lh-pars orbitals LGI**, when controlling for age (removed TBV and dx bc they were not significant predictors in this model), for Q>=3. 



```{r, ZipIncome Plots and tables Q3, echo = FALSE, include=TRUE, results= 'asis'}
outcomes <- LGI_data_q3[,c(7:20)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

rm(lm2)
    
lm2 <- lm(lh_parsorbitalis_lgi ~  zipIncome + V1.Age, data=LGI_data_q3, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Zip-Income", "Age", "TBV"),
  dv.labels = paste(outcomeVars[[11]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(LGI_data_q3, aes(x=zipIncome, y=lh_parsorbitalis_lgi, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Pars Orbitalis LGI') +
    xlab('Zip-Income') +
    theme_classic()

```


# LGI Results, compare results for data quality Q>=4 vs. data quality Q>=3, Regression Models: Dx




```{r, Dx Models Q4, echo=FALSE, include=FALSE, eval=FALSE, results= 'asis'}
set.seed(1)

rm(outcomes)
n <- 14
outcomes <- LGI_data_q4[,c(7:20)]
outcomeVars = names(outcomes)


## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ LGI_data_q4$dxCoded + LGI_data_q4$TBV + LGI_data_q4$V1.Age + LGI_data_q4$sexCoded)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Dx", "TBV", "Age", "Sex"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```


### Dx Results, Q>=4

* Dx predicts **left hemisphere pars triangularis and right hemisphere middle temporal LGI**, when controlling for TBV, age, and sex (the latter were not sig. predictors for RH MTG LGI, so removed from the model). 


+ **Participants with ASD show higher lh pars triangularis LGI than TD participants, controlling for other variables.** 


+ **ASD participants show *lower* rh MTG LGI than TD participants.**


```{r, Dx Plots and tables Q4, echo = FALSE, include=TRUE, results= 'asis'}
rm(outcomes)

outcomes <- LGI_data_q4[,c(7:20)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

     lm2 <- lm(lh_parstriangularis_lgi ~  dxCoded + TBV + sexCoded, data=LGI_data_q4, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Dx", "TBV", "Sex"),
  dv.labels = paste(outcomeVars[[13]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(LGI_data_q4, aes(x=Dx, y=lh_parstriangularis_lgi, color=Dx)) + 
    geom_boxplot() +
    theme(text = element_text(size = 20)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Pars Triangularis LGI') +
    xlab('Diagnosis') +
    theme_classic()
    
    lm2 <- lm(rh_middletemporal_lgi ~  dxCoded + TBV, data=LGI_data_q4, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Dx", "TBV"),
  dv.labels = paste(outcomeVars[[4]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(LGI_data_q4, aes(x=Dx, y=rh_middletemporal_lgi, color=Dx)) + 
    geom_boxplot() +
    theme(text = element_text(size = 20)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('RH Middle Temporal LGI') +
    xlab('Diagnosis') +
    theme_classic()
    
   
    
    

```




```{r, Dx Models Q3, echo=FALSE, include=FALSE, eval=FALSE, results= 'asis'}
set.seed(1)

rm(outcomes)
n <- 14
outcomes <- LGI_data_q3[,c(7:20)]
outcomeVars = names(outcomes)


## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ LGI_data_q3$dxCoded + LGI_data_q3$TBV + LGI_data_q3$V1.Age +LGI_data_q3$sexCoded)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Dx", "TBV", "Age", "Sex"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```

### Dx Results, Q>=3

+ Diagnosis **not significantly associated with LGI** in the Q>=3 dataset (after removing SES variables from the model). Including results here for comparison to the Q4 model results. 

```{r, Dx Plots and tables Q3, echo = FALSE, include=TRUE, results= 'asis'}

rm(outcomes)


outcomes <- LGI_data_q3[,c(7:20)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

     lm2 <- lm(lh_parstriangularis_lgi ~  dxCoded + TBV +sexCoded, data=LGI_data_q3, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Dx", "TBV", "Sex"),
  dv.labels = paste(outcomeVars[[13]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(LGI_data_q3, aes(x=Dx, y=lh_parstriangularis_lgi, color=Dx)) + 
    geom_boxplot() +
    theme(text = element_text(size = 20)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Pars Triangularis LGI') +
    xlab('Diagnosis') +
    theme_classic()
    
    lm2 <- lm(rh_middletemporal_lgi ~  dxCoded + TBV, data=LGI_data_q3, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Dx", "TBV"),
  dv.labels = paste(outcomeVars[[4]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(LGI_data_q3, aes(x=Dx, y=rh_middletemporal_lgi, color=Dx)) + 
    geom_boxplot() +
    theme(text = element_text(size = 20)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('RH Middle Temporal LGI') +
    xlab('Diagnosis') +
    theme_classic()
    
    

```



# LGI Results, compare results for data quality Q>=4 vs. data quality Q>=3, Regression Models: Sex/Gender

### Sex/Gender Results, Q>=4


+ Sex predicts **lh pars opercularis LGI**, controlling for TBV, dx (removed age bc it was not significant). Boys show higher lh pars opercularis LGI than girls. 

```{r, Sex Models Q4, echo=FALSE, include=FALSE, eval=FALSE, results= 'asis'}
set.seed(1)

n <- 14
outcomes <- LGI_data_q4[,c(7:20)]
outcomeVars = names(outcomes)



## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ LGI_data_q4$sexCoded + LGI_data_q4$TBV +LGI_data_q4$dxCoded)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Sex", "TBV", "Dx"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```


```{r, SexEffectsQ4, echo=FALSE, include=TRUE, results= 'asis'}

rm(outcomes)
outcomes <- LGI_data_q4[,c(7:20)]
outcomeVars = names(outcomes)

       #rm(lm2)
lm2 <- lm(lh_parsopercularis_lgi ~  sexCoded + dxCoded + TBV, data=LGI_data_q4, na.action = na.exclude)
cat(tab_model(lm2, pred.labels = c("Intercept", "Sex", "Dx", "TBV"),
  dv.labels = paste(outcomeVars[[9]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")

ggplot(LGI_data_q4, aes(x=SEX, y=lh_parsopercularis_lgi, color=SEX)) + 
  geom_boxplot() +
  theme(text = element_text(size = 20)) +
  scale_color_manual(values=c("purple","blue")) +
  scale_fill_manual(values=c("purple","blue")) +
  ylab('LH Pars Opercularis LGI') +
  xlab('Sex/Gender') +
  theme_classic()
```


### Sex Results Q>=3

+ Sex predicts **lh pars opercularis LGI**, controlling for TBV and dx (removed age bc it was insignificant). Boys show higher lh pars opercularis LGI than girls. 




```{r, Sex Models Q3, echo=FALSE, include=FALSE, eval=FALSE, results= 'asis'}
set.seed(1)

rm(outcomes)
n <- 14
outcomes <- LGI_data_q3[,c(7:20)]
outcomeVars = names(outcomes)


## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ LGI_data_q3$sexCoded + LGI_data_q3$TBV + LGI_data_q3$V1.Age +LGI_data_q3$dxCoded)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Sex", "TBV", "Age", "Dx"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```



```{r, SexEffectsQ3, echo=FALSE, include=TRUE, results= 'asis'}

rm(outcomes)
outcomes <- LGI_data_q3[,c(7:20)]
outcomeVars = names(outcomes)
       rm(lm2)
lm2 <- lm(lh_parsopercularis_lgi ~  sexCoded + dxCoded + TBV, data=LGI_data_q3, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Sex", "Dx", "TBV"),
  dv.labels = paste(outcomeVars[[9]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")

ggplot(LGI_data_q3, aes(x=SEX, y=lh_parsopercularis_lgi, color=SEX)) + 
  geom_boxplot() +
  theme(text = element_text(size = 20)) +
  scale_color_manual(values=c("purple","blue")) +
  scale_fill_manual(values=c("purple","blue")) +
  ylab('LH Pars Opercularis LGI') +
  xlab('Sex/Gender') +
  theme_classic()
```

# LGI Results, Associations with Behavioral Data

### Bivariate correlations with bx data, ASD Only, Q>=4
```{r corrplots-ASD Bx Q4, include=TRUE, echo=FALSE, warning=FALSE, fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot ASD Only, with Bx Data'}

rm(SES_corr_ASD)

options(digits = 2)
SES_corr_ASD <- rcorr(as.matrix(LGI_data_q4_ASD[,c("V1.Age", "sexCoded","ADOS_Total", "GrossMot_T", "VisRec_T", "FineMot_T", "RecLang_T", "ExpLang_T", "ELC_SS", "MEL_cat", "INR", "SES1", "zipIncome","lh_transversetemporal_lgi", "rh_transversetemporal_lgi", "lh_superiortemporal_lgi", "rh_superiortemporal_lgi", "lh_middletemporal_lgi", "rh_middletemporal_lgi", "lh_parsopercularis_lgi", "rh_parsopercularis_lgi", "lh_parsorbitalis_lgi", "rh_parsorbitalis_lgi", "lh_parstriangularis_lgi", "rh_parstriangularis_lgi", "TBV")], use="pairwise.complete.obs"))


corrplot(SES_corr_ASD$r, method = "color",  type = "lower",outline = T, order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_corr_ASD$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.4, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```



### Bivariate correlations with bx data, ASD Only, Q>=3
```{r corrplots-ASD Bx Q3, include=TRUE, echo=FALSE, warning=FALSE, fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot ASD Only, with Bx Data'}


rm(SES_corr_ASD)

options(digits = 2)
SES_corr_ASD <- rcorr(as.matrix(LGI_data_q3_ASD[,c("V1.Age", "sexCoded","ADOS_Total", "GrossMot_T", "VisRec_T", "FineMot_T", "RecLang_T", "ExpLang_T", "ELC_SS", "MEL_cat", "INR", "SES1", "zipIncome","lh_transversetemporal_lgi", "rh_transversetemporal_lgi", "lh_superiortemporal_lgi", "rh_superiortemporal_lgi", "lh_middletemporal_lgi", "rh_middletemporal_lgi", "lh_parsopercularis_lgi", "rh_parsopercularis_lgi", "lh_parsorbitalis_lgi", "rh_parsorbitalis_lgi", "lh_parstriangularis_lgi", "rh_parstriangularis_lgi", "TBV")], use="pairwise.complete.obs"))


corrplot(SES_corr_ASD$r, method = "color",  type = "lower",outline = T, order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_corr_ASD$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.4, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```


### Bivariate correlations with bx data, TD Only, Q>=4
```{r corrplots-TD Bx Q4, include=TRUE, echo=FALSE, warning=FALSE, fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot TD Only, with Bx Data'}
rm(SES_corr_TD)

options(digits = 2)
SES_corr_TD <- rcorr(as.matrix(LGI_data_q4_TD[,c("V1.Age", "sexCoded", "GrossMot_T", "VisRec_T", "FineMot_T", "RecLang_T", "ExpLang_T", "ELC_SS", "MEL_cat", "INR", "SES1", "zipIncome","lh_transversetemporal_lgi", "rh_transversetemporal_lgi", "lh_superiortemporal_lgi", "rh_superiortemporal_lgi", "lh_middletemporal_lgi", "rh_middletemporal_lgi", "lh_parsopercularis_lgi", "rh_parsopercularis_lgi", "lh_parsorbitalis_lgi", "rh_parsorbitalis_lgi", "lh_parstriangularis_lgi", "rh_parstriangularis_lgi", "TBV")], use="pairwise.complete.obs"))


corrplot(SES_corr_TD$r, method = "color",  type = "lower",outline = T, order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_corr_TD$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.4, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```



### Bivariate correlations with bx data, TD Only, Q>=3
```{r corrplots-TD Bx Q3, include=TRUE, echo=FALSE, warning=FALSE, fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot TD Only, with Bx Data'}

rm(SES_corr_TD)

options(digits = 2)
SES_corr_TD <- rcorr(as.matrix(LGI_data_q3_TD[,c("V1.Age", "sexCoded","GrossMot_T", "VisRec_T", "FineMot_T", "RecLang_T", "ExpLang_T", "ELC_SS", "MEL_cat", "INR", "SES1", "zipIncome","lh_transversetemporal_lgi", "rh_transversetemporal_lgi", "lh_superiortemporal_lgi", "rh_superiortemporal_lgi", "lh_middletemporal_lgi", "rh_middletemporal_lgi", "lh_parsopercularis_lgi", "rh_parsopercularis_lgi", "lh_parsorbitalis_lgi", "rh_parsorbitalis_lgi", "lh_parstriangularis_lgi", "rh_parstriangularis_lgi", "TBV")], use="pairwise.complete.obs"))


corrplot(SES_corr_TD$r, method = "color",  type = "lower",outline = T, order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_corr_TD$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.4, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```




### Regression Results for Bx Models, Q>=4
```{r, Bx Models Q4, echo=FALSE, include=FALSE, eval=FALSE, results= 'asis'}



## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ LGI_data_q4$ELC_SS + LGI_data_q4$TBV + LGI_data_q4$dxCoded)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Dx", "Rec Lang T", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```



+ Receptive Language is postively associated with **rh pars orbitalis LGI**, controlling for dx and age for Q>=4 (TBV not a significant predictor, removed from the model). I should probably make partial regression plots to better visualize the assocations.

+ Insignificant negative relationship between receptive language and **lh pars orbitalis LGI** that **is** significant in the Q>=3 dataset (see below). The negative effect looks to be mostly driven by the ASD group, although there is no significant RecLangXGroup interaction. 

+ Expressive language predicts **rh pars opercularis LGI**, controlling for dx, TBV, and age (age not significant, and can be removed). Similar trend for left hempisphere, but not significant. 

+ Both expressive and receptive language predict rh and lh fusiform LGI, but not including in this summary as it's not directly related to the dissertation, but noting for later. ELC also associated with fusiform LGI.



```{r, Bx Effects Q4, echo=FALSE, include=TRUE, results= 'asis'}

rm(outcomes)

n <- 14
outcomes <- LGI_data_q4[,c(7:20)]
outcomeVars = names(outcomes)


       rm(lm2)
lm2 <- lm(rh_parsopercularis_lgi ~  RecLang_T + dxCoded + V1.Age, data=LGI_data_q4, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Rec Lang", "Dx", "Age"),
  dv.labels = paste(outcomeVars[[10]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")



    ggplot(LGI_data_q4, aes(x=RecLang_T, y=rh_parsorbitalis_lgi, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('RH Pars Orbitalis LGI') +
    xlab('Rec. Lang. T-Score') +
    theme_classic()
    
    
          rm(lm2)
lm2 <- lm(lh_parsopercularis_lgi ~  RecLang_T + dxCoded + V1.Age, data=LGI_data_q4, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Rec Lang", "Dx", "Age"),
  dv.labels = paste(outcomeVars[[9]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")



    ggplot(LGI_data_q4, aes(x=RecLang_T, y=lh_parsorbitalis_lgi, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Pars Orbitalis LGI') +
    xlab('Rec. Lang. T-Score') +
    theme_classic()

    
       rm(lm2)
lm2 <- lm(rh_parsopercularis_lgi ~  ExpLang_T + dxCoded, data=LGI_data_q4, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Exp Lang", "Dx"),
  dv.labels = paste(outcomeVars[[10]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")



    ggplot(LGI_data_q4, aes(x=ExpLang_T, y=rh_parsorbitalis_lgi, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('RH Pars Orbitalis LGI') +
    xlab('Rec. Lang. T-Score') +
    theme_classic()

```

+ Receptive Language is **not significantly associated with rh pars orbitalis LGI for the Q>=3 dataset, in contrast to the Q>=4 results**, controlling for dx and age (TBV not a significant predictor, removed from the model). 



+ Significant, negative relationship between receptive language and **lh pars orbitalis LGI** in the Q>=3 dataset (was not quite significant in the Q>=4 dataset) for ASD group, but not for TD group. The RecLangXGroup interaction **is significant** in this dataset. 



+ Can run a special regression model designed for truncated data distributions (e.g., floor effects) in order to verify that this result is not driven just by violations of homoscedasticity assumtion (if we decide to stick with this dataset. . .).



+ No significant relationship between expressive language and **rh pars opercularis LGI**, controlling for dx, TBV, and age in the Q>=3 dataset (in contrast to Q>=4).  

### Regression Results for Bx Models, Q>=3
```{r, Bx Models Q3, echo=FALSE, include=FALSE, eval=FALSE, results= 'asis'}

rm(outcomes)

set.seed(1)

n <- 14
outcomes <- LGI_data_q3[,c(7:20)]
outcomeVars = names(outcomes)


## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ LGI_data_q3$dxCoded + LGI_data_q3$ExpLang_T + LGI_data_q3$TBV)) # change the predictors manually


summaries <- lapply(my_lms, summary)

  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Dx", "Rec Lang T", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```





```{r, Bx Effects Q3, echo=FALSE, include=TRUE, results= 'asis'}

rm(outcomes)
set.seed(1)

n <- 14
outcomes <- LGI_data_q3[,c(7:20)]
outcomeVars = names(outcomes)




       rm(lm2)
lm2 <- lm(rh_parsopercularis_lgi ~  RecLang_T + dxCoded + V1.Age, data=LGI_data_q3, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Rec Lang", "Dx", "Age"),
  dv.labels = paste(outcomeVars[[10]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")



    ggplot(LGI_data_q3, aes(x=RecLang_T, y=rh_parsorbitalis_lgi, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('RH Pars Orbitalis LGI') +
    xlab('Rec. Lang. T-Score') +
    theme_classic()
    
    
          rm(lm2)
lm2 <- lm(lh_parsorbitalis_lgi ~  RecLang_T + dxCoded + V1.Age + RecLang_T*dxCoded, data=LGI_data_q3, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Rec Lang", "Dx", "Age", "RL by Dx Intxn"),
  dv.labels = paste(outcomeVars[[11]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")



    ggplot(LGI_data_q3, aes(x=RecLang_T, y=lh_parsorbitalis_lgi, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Pars Orbitalis LGI') +
    xlab('Rec. Lang. T-Score') +
    theme_classic()

    
       rm(lm2)
lm2 <- lm(rh_parsopercularis_lgi ~  ExpLang_T + dxCoded, data=LGI_data_q3, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Exp Lang", "Dx"),
  dv.labels = paste(outcomeVars[[10]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")



    ggplot(LGI_data_q3, aes(x=ExpLang_T, y=rh_parsorbitalis_lgi, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('RH Pars Orbitalis LGI') +
    xlab('Rec. Lang. T-Score') +
    theme_classic()

```


# CT Results, Bivariate Correlations 


### Bivariate Correlation Plots, ASD&TD Together, Q>=4
```{r corrplots CT, include=TRUE, echo=FALSE, warning=FALSE,  fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot'}



SES_Lang_CT <- rcorr(as.matrix(CT_data_q4[,c("dxCoded","V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "zipIncome","lh_transversetemporal_CT", "rh_transversetemporal_CT", "lh_superiortemporal_CT", "rh_superiortemporal_CT", "lh_middletemporal_CT", "rh_middletemporal_CT", "lh_parsopercularis_CT", "rh_parsopercularis_CT", "lh_parsorbitalis_CT", "rh_parsorbitalis_CT", "lh_parstriangularis_CT", "rh_parstriangularis_CT", "TBV")], use="pairwise.complete.obs"))

#mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/corrPlots/CT", "SES_CT_varsCorr_q45.tiff")
#tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
corrplot(SES_Lang_CT$r, method = "color",  type = "lower", outline = T, addgrid.col = "darkgray", order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_Lang_CT$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```


### Bivariate Correlation ASD and TD, Q>=3
```{r corrplotsQ3 CT, include=TRUE, echo=FALSE, warning=FALSE,  fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot'}



SES_Lang_CT <- rcorr(as.matrix(CT_data_q3[,c("dxCoded", "V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "zipIncome","lh_transversetemporal_CT", "rh_transversetemporal_CT", "lh_superiortemporal_CT", "rh_superiortemporal_CT", "lh_middletemporal_CT", "rh_middletemporal_CT", "lh_parsopercularis_CT", "rh_parsopercularis_CT", "lh_parsorbitalis_CT", "rh_parsorbitalis_CT", "lh_parstriangularis_CT", "rh_parstriangularis_CT", "TBV")], use="pairwise.complete.obs"))

#mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/corrPlots/CT", "SES_CT_varsCorr_q45.tiff")
#tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
corrplot(SES_Lang_CT$r, method = "color",  type = "lower", outline = T, addgrid.col = "darkgray", order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_Lang_CT$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```


### Bivariate correlations, ASD Only, Q>=4
```{r corrplots-ASD CT, include=TRUE, echo=FALSE, warning=FALSE, fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot ASD Only'}

rm(SES_corr_ASD)

CT_data_q4_ASD <- subset(CT_data_q4, CT_data_q4$Dx == "ASD")

options(digits = 2)
SES_corr_ASD <- rcorr(as.matrix(CT_data_q4_ASD[,c("V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "zipIncome","lh_transversetemporal_CT", "rh_transversetemporal_CT", "lh_superiortemporal_CT", "rh_superiortemporal_CT", "lh_middletemporal_CT", "rh_middletemporal_CT", "lh_parsopercularis_CT", "rh_parsopercularis_CT", "lh_parsorbitalis_CT", "rh_parsorbitalis_CT", "lh_parstriangularis_CT", "rh_parstriangularis_CT", "TBV")], use="pairwise.complete.obs"))


corrplot(SES_corr_ASD$r, method = "color",  type = "lower",outline = T, order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_corr_ASD$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```


### Bivariate correlations, ASD Only, Q>=3
```{r corrplots-ASD Q3 CT, include=TRUE, echo=FALSE, warning=FALSE, fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot ASD Only'}

rm(SES_corr_ASD)

CT_data_q3_ASD <- subset(CT_data_q3, CT_data_q3$Dx == "ASD")

options(digits = 2)
SES_corr_ASD <- rcorr(as.matrix(CT_data_q3_ASD[,c("V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "zipIncome","lh_transversetemporal_CT", "rh_transversetemporal_CT", "lh_superiortemporal_CT", "rh_superiortemporal_CT", "lh_middletemporal_CT", "rh_middletemporal_CT", "lh_parsopercularis_CT", "rh_parsopercularis_CT", "lh_parsorbitalis_CT", "rh_parsorbitalis_CT", "lh_parstriangularis_CT", "rh_parstriangularis_CT", "TBV")], use="pairwise.complete.obs"))


corrplot(SES_corr_ASD$r, method = "color",  type = "lower",outline = T, order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_corr_ASD$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```



### Bivariate correlations, TD Only Q>=4
```{r corrplots-TD CT, include=TRUE, echo=FALSE, warning=FALSE, fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot, TD Only'}

rm(SES_corr_TD)
CT_data_q4_TD <- subset(CT_data_q4, CT_data_q4$Dx == "TD")

options(digits = 2)
SES_corr_TD <- rcorr(as.matrix(CT_data_q4_TD[,c("V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "zipIncome","lh_transversetemporal_CT", "rh_transversetemporal_CT", "lh_superiortemporal_CT", "rh_superiortemporal_CT", "lh_middletemporal_CT", "rh_middletemporal_CT", "lh_parsopercularis_CT", "rh_parsopercularis_CT", "lh_parsorbitalis_CT", "rh_parsorbitalis_CT", "lh_parstriangularis_CT", "rh_parstriangularis_CT", "TBV")], use="pairwise.complete.obs"))

#mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/corrPlots/CT", #"SES_varsCorr_ASD_q45.tiff")
#tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
corrplot(SES_corr_TD$r, method = "color",  type = "lower", outline = T, order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_corr_TD$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()

```




### Bivariate correlations, TD Only Q>=3
```{r corrplots-TDQ3 CT, include=TRUE, echo=FALSE, warning=FALSE, fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot, TD Only'}

rm(SES_corr_TD)

CT_data_q3_TD <- subset(CT_data_q3, CT_data_q3$Dx == "TD")

options(digits = 2)
SES_corr_TD <- rcorr(as.matrix(CT_data_q3_TD[,c("V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "zipIncome","lh_transversetemporal_CT", "rh_transversetemporal_CT", "lh_superiortemporal_CT", "rh_superiortemporal_CT", "lh_middletemporal_CT", "rh_middletemporal_CT", "lh_parsopercularis_CT", "rh_parsopercularis_CT", "lh_parsorbitalis_CT", "rh_parsorbitalis_CT", "lh_parstriangularis_CT", "rh_parstriangularis_CT", "TBV")], use="pairwise.complete.obs"))

#mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/corrPlots/CT", #"SES_varsCorr_ASD_q45.tiff")
#tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
corrplot(SES_corr_TD$r, method = "color",  type = "lower", outline = T, order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_corr_TD$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```


# CT Results, compare results for data quality Q>=4 vs. data quality Q>=3, Regression Models: INR

```{r, regTables INR Q4 CT, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}


set.seed(1)
rm(outcomes)
# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 15
outcomes <- CT_data_q4[,c(18:32)]
outcomeVars = names(outcomes)



#coVars <- CT_data_q4[,c(4:6, 36)]

#sesVars <- CT_data_q4[,c(37:39, 41:42)]


## INR Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ CT_data_q4$INR + CT_data_q4$V1.Age)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Income:Needs", "Sex"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```




```{r, regTablesQ3 CT, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}


rm(outcomes)
set.seed(1)

# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 15
outcomes <- CT_data_q3[,c(18:32)]
outcomeVars = names(outcomes)

#coVars <- CT_data_q4[,c(4:6, 36)]
#sesVars <- CT_data_q4[,c(37:39, 41:42)]


## INR Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ CT_data_q3$INR +CT_data_q3$V1.Age + CT_data_q3$sexCoded)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Income:Needs", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```


### INR Results Q>=4




```{r, INR Plots and tables Q4 CT, echo = FALSE, include=TRUE, results= 'asis'}
#LGI Data 

outcomes <- CT_data_q4[,c(18:32)]
outcomeVars = names(outcomes)



cat("\n")
cat("\n")
cat("\n")
cat("\n")
    
lm2 <- lm(lh_middletemporal_CT ~  INR + V1.Age + sexCoded, data=CT_data_q4, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Income:Needs", "Age", "Sex"),
  dv.labels = paste(outcomeVars[[10]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(CT_data_q4, aes(x=INR, y=lh_middletemporal_CT, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Middle Temporal CT') +
    xlab('Income:Needs Ratio') +
    theme_classic()

```

+ INR Predicts **LH middletemporal cortical thickness (CT),**  controlling for age and sex/gender in the Q>=4 dataset. 



### INR Results Q>3



```{r, INR Plots and tables Q3 CT, echo = FALSE, include=TRUE, results= 'asis'}

rm(outcomes)

outcomes <- CT_data_q3[,c(18:32)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

    
lm2 <- lm(rh_parstriangularis_CT ~  INR + V1.Age + sexCoded, data=CT_data_q3, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Income:Needs", "Age", "Sex"),
  dv.labels = paste(outcomeVars[[14]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(CT_data_q3, aes(x=INR, y=rh_parstriangularis_CT, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('RH Pars Triangularis CT') +
    xlab('Income:Needs Ratio') +
    theme_classic()
    
    
    rm(lm2)
    lm2 <- lm(lh_middletemporal_CT ~  INR + V1.Age + sexCoded, data=CT_data_q3, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Income:Needs", "Age", "Sex"),
  dv.labels = paste(outcomeVars[[1]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(CT_data_q3, aes(x=INR, y=lh_middletemporal_CT, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Middle Temporal CT') +
    xlab('Income:Needs Ratio') +
    theme_classic()
    
    
        rm(lm2)
    lm2 <- lm(lh_superiortemporal_CT ~  INR+ V1.Age + sexCoded, data=CT_data_q3, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Income:Needs", "Age", "Sex"),
  dv.labels = paste(outcomeVars[[2]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(CT_data_q3, aes(x=INR, y=lh_superiortemporal_CT, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Superior Temporal CT') +
    xlab('Income:Needs Ratio') +
    theme_classic()

```



+ INR Predicts **RH pars triangularis, LH middletemporal, and  LH superiortemporal cortical thickness (CT),**  controlling for age and sex/gender in the Q>=3 dataset. 



# CT Results, compare results for data quality Q>=4 vs. data quality Q>=3, Regression Models: SES1

```{r, regTables SES1 Q4 CT, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}


set.seed(1)
rm(outcomes)
# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 15
outcomes <- CT_data_q4[,c(18:32)]
outcomeVars = names(outcomes)



#coVars <- CT_data_q4[,c(4:6, 36)]

#sesVars <- CT_data_q4[,c(37:39, 41:42)]


## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ CT_data_q4$SES1 + CT_data_q4$sexCoded+ CT_data_q4$V1.Age)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Income:Needs", "TBV", "Sex"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```





```{r, regTablesQ3 CT SES1, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}


rm(outcomes)
set.seed(1)

# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 14
outcomes <- CT_data_q3[,c(18:31)]
outcomeVars = names(outcomes)

#coVars <- CT_data_q4[,c(4:6, 36)]
#sesVars <- CT_data_q4[,c(37:39, 41:42)]


## SES1 Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ CT_data_q3$SES1 + CT_data_q3$sexCoded +CT_data_q3$V1.Age)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
    cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Income:Needs", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```


### SES1 Results Q>=4

+ SES1 predicts **rh middle temporal CT** (controlling for age and sex). 

+ SES1 predicts **lh pars opercularis CT** (controlling for age and sex). 

+ TBV not a significant predictor of CT generally. 



```{r, SES1 Plots and tables Q4 CT, echo = FALSE, include=TRUE, results= 'asis'}
#LGI Data 

rm(outcomes)
outcomes <- CT_data_q4[,c(18:32)]
outcomeVars = names(outcomes)



cat("\n")
cat("\n")
cat("\n")
cat("\n")
    
#lm2 <- lm(lh_Mean_CT ~  SES1 + V1.Age + sexCoded, data=CT_data_q4, na.action = na.exclude)   
#cat(tab_model(lm2, pred.labels = c("Intercept", "SES1", "Age", "Sex"),
 # dv.labels = paste(outcomeVars[[7]]),
  #string.pred = "Coeffcient",
  #string.ci = "CI (95%)",
  #string.p = "p-Value")$knitr,"\n--------\n")


# cat("\n")
# cat("\n")
# cat("\n")
# cat("\n")
# cat("\n")
# cat("\n")
# cat("\n")
# cat("\n")

   
# ggplot(CT_data_q4, aes(x=SES1, y=lh_Mean_CT, color=Dx, shape=Dx)) +
 #   geom_point() +
  #  geom_smooth(method=lm, aes(fill=Dx)) +
   # scale_color_manual(values=c("red","blue")) +
    #scale_fill_manual(values=c("red","blue")) +
    #ylab('LH Mean CT') +
    #xlab('Neighborhood Advantage') +
    #theme_classic()
    
    
# cat("\n")
# cat("\n")
# cat("\n")
# cat("\n")
    
# lm2 <- lm(rh_Mean_CT ~  SES1 + V1.Age + sexCoded, data=CT_data_q4, na.action = na.exclude)   
# cat(tab_model(lm2, pred.labels = c("Intercept", "SES1", "Age", "Sex"),
#   dv.labels = paste(outcomeVars[[15]]),
#   string.pred = "Coeffcient",
#   string.ci = "CI (95%)",
#   string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    # ggplot(CT_data_q4, aes(x=SES1, y=rh_Mean_CT, color=Dx, shape=Dx)) +
    # geom_point() +
    # geom_smooth(method=lm, aes(fill=Dx)) +
    # scale_color_manual(values=c("red","blue")) +
    # scale_fill_manual(values=c("red","blue")) +
    # ylab('RH Mean CT') +
    # xlab('Neighborhood Advantage') +
    # theme_classic()
    # 
    
    lm2 <- lm(lh_parsopercularis_CT ~  SES1 + V1.Age + sexCoded, data=CT_data_q4, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "SES1", "Age", "Sex"),
  dv.labels = paste(outcomeVars[[4]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(CT_data_q4, aes(x=SES1, y=lh_parsopercularis_CT, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Pars Opercularis CT') +
    xlab('Neighborhood Advantage (PC1)') +
    theme_classic()
    
    
      lm2 <- lm(rh_middletemporal_CT ~  SES1 + V1.Age + sexCoded, data=CT_data_q4, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "SES1", "Age", "Sex"),
  dv.labels = paste(outcomeVars[[9]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(CT_data_q4, aes(x=SES1, y=rh_middletemporal_CT, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('RH Middle Temporal CT') +
    xlab('Neighborhood Advantage (PC1)') +
    theme_classic()

```




### SES1 Results Q>3


+ Associations between SES1 and pars opercularis / middle temporal gyrus are not significant in the Q>=3 dataset, controlling for age, sex/gender, and TBV.


```{r, SES1 Plots and tables Q3 CT, echo = FALSE, include=TRUE, results= 'asis'}

rm(outcomes)

outcomes <- CT_data_q3[,c(18:32)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

#     
# lm2 <- lm(rh_parstriangularis_CT ~  SES1 + TBV + V1.Age + sexCoded, data=CT_data_q3, na.action = na.exclude)   
# cat(tab_model(lm2, pred.labels = c("Intercept", "SES1", "TBV", "Age", "Sex"),
#   dv.labels = paste(outcomeVars[[14]]),
#   string.pred = "Coeffcient",
#   string.ci = "CI (95%)",
#   string.p = "p-Value")$knitr,"\n--------\n")
# 
# 
# cat("\n")
# cat("\n")
# cat("\n")
# cat("\n")
# cat("\n")
# cat("\n")
# cat("\n")
# cat("\n")
# 
#     ggplot(CT_data_q3, aes(x=SES1, y=rh_parstriangularis_CT, color=Dx, shape=Dx)) +
#     geom_point() +
#     geom_smooth(method=lm, aes(fill=Dx)) +
#     scale_color_manual(values=c("red","blue")) +
#     scale_fill_manual(values=c("red","blue")) +
#     ylab('RH Pars Triangularis CT') +
#     xlab('Neighborhood Advantage (PC1)') +
#     theme_classic()
    
    
    rm(lm2)
    lm2 <- lm(rh_middletemporal_CT ~  SES1 + TBV + V1.Age + sexCoded, data=CT_data_q3, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "SES1", "TBV", "Age", "Sex"),
  dv.labels = paste(outcomeVars[[9]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(CT_data_q3, aes(x=SES1, y=rh_middletemporal_CT, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('RH Middle Temporal CT') +
    xlab('Neighborhood Advantage (PC1)')+
    theme_classic()
    
      rm(lm2)
    lm2 <- lm(lh_parsopercularis_CT ~  SES1 + TBV + V1.Age + sexCoded, data=CT_data_q3, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "SES1", "TBV", "Age", "Sex"),
  dv.labels = paste(outcomeVars[[9]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(CT_data_q3, aes(x=SES1, y=lh_parsopercularis_CT, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Pars Opercularis CT') +
    xlab('Neighborhood Advantage (PC1)')+
    theme_classic()
    
    
#         rm(lm2)
#     lm2 <- lm(lh_superiortemporal_CT ~  SES1 + TBV + V1.Age + sexCoded, data=CT_data_q3, na.action = na.exclude)   
# cat(tab_model(lm2, pred.labels = c("Intercept", "SES1", "TBV", "Age", "Sex"),
#   dv.labels = paste(outcomeVars[[2]]),
#   string.pred = "Coeffcient",
#   string.ci = "CI (95%)",
#   string.p = "p-Value")$knitr,"\n--------\n")
# 
# 
# cat("\n")
# cat("\n")
# cat("\n")
# cat("\n")
# cat("\n")
# cat("\n")
# cat("\n")
# cat("\n")
# 
#     ggplot(CT_data_q3, aes(x=SES1, y=lh_superiortemporal_CT, color=Dx, shape=Dx)) +
#     geom_point() +
#     geom_smooth(method=lm, aes(fill=Dx)) +
#     scale_color_manual(values=c("red","blue")) +
#     scale_fill_manual(values=c("red","blue")) +
#     ylab('LH Superior Temporal CT') +
#     xlab('Neighborhood Advantage (PC1)') +
#     theme_classic()

```




# CT Results, compare results for data quality Q>=4 vs. data quality Q>=3, Regression Models: MEL

```{r, regTables MEL Q4 CT, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}


set.seed(1)
rm(outcomes)
# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 15
outcomes <- CT_data_q4[,c(18:32)]
outcomeVars = names(outcomes)



#coVars <- CT_data_q4[,c(4:6, 36)]

#sesVars <- CT_data_q4[,c(37:39, 41:42)]


## MEL Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ CT_data_q4$MEL_cat + CT_data_q4$sexCoded+ CT_data_q4$V1.Age)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Income:Needs", "TBV", "Sex"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```





```{r, regTablesQ3 CT MEL, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}


rm(outcomes)
set.seed(1)

# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 15
outcomes <- CT_data_q3[,c(18:32)]
outcomeVars = names(outcomes)

#coVars <- CT_data_q4[,c(4:6, 36)]
#sesVars <- CT_data_q4[,c(37:39, 41:42)]


## MEL Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ CT_data_q3$MEL_cat + CT_data_q3$sexCoded +CT_data_q3$V1.Age)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
    cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Income:Needs", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```


### MEL Results Q>=4


+ MEL not a significant predictor of cortical thickness in language regions, controlling for age and sex. 



### MEL Results Q>=3


+ MEL not a significant predictor of cortical thickness in language regions, controlling for age and sex. 


# CT Results, compare results for data quality Q>=4 vs. data quality Q>=3, Regression Models: ZipIncome

```{r, regTables ZipIncome Q4 CT, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}


set.seed(1)
rm(outcomes)
# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 15
outcomes <- CT_data_q4[,c(18:32)]
outcomeVars = names(outcomes)



#coVars <- CT_data_q4[,c(4:6, 36)]

#sesVars <- CT_data_q4[,c(37:39, 41:42)]


## MEL Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ CT_data_q4$zipIncome + CT_data_q4$V1.Age)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Income:Needs", "TBV", "Sex"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```

### Zip-Income Results, Q>=4 

+ Zip-Income not a significant predictor of CT in language regions, controlling for age in sex.



```{r, regTablesQ3 CT zipIncome, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}


rm(outcomes)
set.seed(1)

# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 15
outcomes <- CT_data_q3[,c(18:32)]
outcomeVars = names(outcomes)

#coVars <- CT_data_q4[,c(4:6, 36)]
#sesVars <- CT_data_q4[,c(37:39, 41:42)]


## MEL Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ CT_data_q3$zipIncome + CT_data_q3$sexCoded +CT_data_q3$V1.Age)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
    cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Zip-Income", "Age", "Sex"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```


### Zip-Income Results, Q>=3

+ Zip-Income not a significant predictor of CT in language regions, controlling for age in sex.


# CT Results, compare results for data quality Q>=4 vs. data quality Q>=3, Regression Models: Dx

```{r, regTables Dx Q4 CT, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}


set.seed(1)
rm(outcomes)
# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 15
outcomes <- CT_data_q4[,c(18:32)]
outcomeVars = names(outcomes)



#coVars <- CT_data_q4[,c(4:6, 36)]

#sesVars <- CT_data_q4[,c(37:39, 41:42)]


## MEL Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ CT_data_q4$dxCoded + CT_data_q4$V1.Age + CT_data_q4$sexCoded)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Dx", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```

### Dx Results, Q>=4 


```{r, Dx Plots and tables Q4 CT, echo = FALSE, include=TRUE, results= 'asis'}
rm(outcomes)

outcomes <- CT_data_q4[,c(18:32)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

     lm2 <- lm(lh_parsorbitalis_CT ~  dxCoded + V1.Age, data=CT_data_q4, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Dx", "Age"),
  dv.labels = paste(outcomeVars[[5]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(CT_data_q4, aes(x=Dx, y=lh_parsorbitalis_CT, color=Dx)) + 
    geom_boxplot() +
    theme(text = element_text(size = 20)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Pars Orbitalis CT') +
    xlab('Diagnosis') +
    theme_classic()
    


```


+ Dx predicts **left hemisphere pars orbitalis CT**, controlling for age (sex not a significant predictor) in the Q>=4 dataset.



```{r, regTablesQ3 Dx CT, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}


rm(outcomes)
set.seed(1)

# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 15
outcomes <- CT_data_q3[,c(18:32)]
outcomeVars = names(outcomes)

#coVars <- CT_data_q4[,c(4:6, 36)]
#sesVars <- CT_data_q4[,c(37:39, 41:42)]


## MEL Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ CT_data_q3$dxCoded + CT_data_q3$sexCoded +CT_data_q3$V1.Age)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
    cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Income:Needs", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```


### Dx Results, Q>=3


```{r, Dx Plots and tables Q3 CT, echo = FALSE, include=TRUE, results= 'asis'}
rm(outcomes)

outcomes <- CT_data_q3[,c(18:32)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

     lm2 <- lm(lh_parsorbitalis_CT ~  dxCoded + V1.Age, data=CT_data_q3, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Dx", "Age"),
  dv.labels = paste(outcomeVars[[5]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(CT_data_q3, aes(x=Dx, y=lh_parsorbitalis_CT, color=Dx)) + 
    geom_boxplot() +
    theme(text = element_text(size = 20)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Pars Orbitalis CT') +
    xlab('Diagnosis') +
    theme_classic()
    


```


+ Dx predicts **left hemisphere pars orbitalis CT**, controlling for age (sex not a significant predictor) in the Q>=3 dataset.




# CT Results, compare results for data quality Q>=4 vs. data quality Q>=3, Regression Models: Sex/Gender



```{r, regTables Sex Q4 CT, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}


set.seed(1)
rm(outcomes)
# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 15
outcomes <- CT_data_q4[,c(18:32)]
outcomeVars = names(outcomes)



#coVars <- CT_data_q4[,c(4:6, 36)]

#sesVars <- CT_data_q4[,c(37:39, 41:42)]


## MEL Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ CT_data_q4$dxCoded + CT_data_q4$V1.Age + CT_data_q4$sexCoded)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Dx", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```

### Sex Results, Q>=4 


+ Sex/gender predicts right hemisphere pars triangularis CT, controlling for age and dx. 
```{r, Sex Plots and tables Q4 CT, echo = FALSE, include=TRUE, results= 'asis'}
rm(outcomes)

outcomes <- CT_data_q4[,c(18:32)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

     lm2 <- lm(rh_parstriangularis_CT ~  sexCoded + V1.Age +dxCoded, data=CT_data_q4, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Sex", "Age", "Dx"),
  dv.labels = paste(outcomeVars[[14]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(CT_data_q4, aes(x=sexCoded, y=rh_parstriangularis_CT, color=SEX)) + 
    geom_boxplot() +
    theme(text = element_text(size = 20)) +
    scale_color_manual(values=c("purple","blue")) +
    scale_fill_manual(values=c("purple","blue")) +
    ylab('RH Pars Triangularis CT') +
    xlab('Sex/Gender') +
    theme_classic()
    


```


+ Sex predicts **right hemisphere pars orbitalis CT**, controlling for age and dx in the Q>=4 dataset.



```{r, regTablesQ3 Sex CT, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}


rm(outcomes)
set.seed(1)

# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 15
outcomes <- CT_data_q3[,c(18:32)]
outcomeVars = names(outcomes)

#coVars <- CT_data_q4[,c(4:6, 36)]
#sesVars <- CT_data_q4[,c(37:39, 41:42)]


## MEL Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ CT_data_q3$sexCoded +CT_data_q3$V1.Age +CT_data_q3$dxCoded)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
    cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Income:Needs", "Age"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```


### Sex/Gender Results, Q>=3

+ Sex predicts **right hemisphere pars orbitalis CT**, controlling for age and dx in the Q>=3 dataset.



```{r, Sex Plots and tables Q3 CT, echo = FALSE, include=TRUE, results= 'asis'}
rm(outcomes)

outcomes <- CT_data_q3[,c(18:32)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

     lm2 <- lm(rh_parstriangularis_CT ~  sexCoded + V1.Age +dxCoded, data=CT_data_q3, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "Sex", "Age", "Dx"),
  dv.labels = paste(outcomeVars[[5]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(CT_data_q3, aes(x=sexCoded, y=rh_parsorbitalis_CT, color=SEX)) + 
    geom_boxplot() +
    theme(text = element_text(size = 20)) +
    scale_color_manual(values=c("purple","blue")) +
    scale_fill_manual(values=c("purple","blue")) +
    ylab('RH Pars Orbitalis CT') +
    xlab('Sex/Gender') +
    theme_classic()
    


```





# SA Results, Bivariate Correlations

### Bivariate Correlation Plots, ASD&TD Together, Q>=4
```{r corrplots SA, include=TRUE, echo=FALSE, warning=FALSE,  fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot'}




SES_Lang_area <- rcorr(as.matrix(SA_data_q4[,c("dxCoded","V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "zipIncome","lh_transversetemporal_area", "rh_transversetemporal_area", "lh_superiortemporal_area", "rh_superiortemporal_area", "lh_middletemporal_area", "rh_middletemporal_area", "lh_parsopercularis_area", "rh_parsopercularis_area", "lh_parsorbitalis_area", "rh_parsorbitalis_area", "lh_parstriangularis_area", "rh_parstriangularis_area", "TBV")], use="pairwise.complete.obs"))

#mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/corrPlots/SA", "SES_area_varsCorr_q45.tiff")
#tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
corrplot(SES_Lang_area$r, method = "color",  type = "lower", outline = T, addgrid.col = "darkgray", order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_Lang_area$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```


### Bivariate Correlation ASD and TD, Q>=3
```{r corrplotsQ3 SA, include=TRUE, echo=FALSE, warning=FALSE,  fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot'}

rm(SES_Lang_area)

SES_Lang_area <- rcorr(as.matrix(SA_data_q3[,c("dxCoded", "V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "zipIncome","lh_transversetemporal_area", "rh_transversetemporal_area", "lh_superiortemporal_area", "rh_superiortemporal_area", "lh_middletemporal_area", "rh_middletemporal_area", "lh_parsopercularis_area", "rh_parsopercularis_area", "lh_parsorbitalis_area", "rh_parsorbitalis_area", "lh_parstriangularis_area", "rh_parstriangularis_area", "TBV")], use="pairwise.complete.obs"))

#mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/corrPlots/SA", "SES_area_varsCorr_q45.tiff")
#tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
corrplot(SES_Lang_area$r, method = "color",  type = "lower", outline = T, addgrid.col = "darkgray", order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_Lang_area$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```


### Bivariate correlations, ASD Only, Q>=4
```{r corrplots-ASD SA, include=TRUE, echo=FALSE, warning=FALSE, fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot ASD Only'}



SA_data_q4_ASD <- subset(SA_data_q4, SA_data_q4$Dx == "ASD")

options(digits = 2)
SES_corr_ASD <- rcorr(as.matrix(SA_data_q4_ASD[,c("V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "zipIncome","lh_transversetemporal_area", "rh_transversetemporal_area", "lh_superiortemporal_area", "rh_superiortemporal_area", "lh_middletemporal_area", "rh_middletemporal_area", "lh_parsopercularis_area", "rh_parsopercularis_area", "lh_parsorbitalis_area", "rh_parsorbitalis_area", "lh_parstriangularis_area", "rh_parstriangularis_area", "TBV")], use="pairwise.complete.obs"))


corrplot(SES_corr_ASD$r, method = "color",  type = "lower",outline = T, order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_corr_ASD$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```


### Bivariate correlations, ASD Only, Q>=3
```{r corrplots-ASD Q3 SA, include=TRUE, echo=FALSE, warning=FALSE, fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot ASD Only'}

rm(SES_corr_ASD)

SA_data_q3_ASD <- subset(SA_data_q3, SA_data_q3$Dx == "ASD")

options(digits = 2)
SES_corr_ASD <- rcorr(as.matrix(SA_data_q3_ASD[,c("V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "zipIncome","lh_transversetemporal_area", "rh_transversetemporal_area", "lh_superiortemporal_area", "rh_superiortemporal_area", "lh_middletemporal_area", "rh_middletemporal_area", "lh_parsopercularis_area", "rh_parsopercularis_area", "lh_parsorbitalis_area", "rh_parsorbitalis_area", "lh_parstriangularis_area", "rh_parstriangularis_area", "TBV")], use="pairwise.complete.obs"))


corrplot(SES_corr_ASD$r, method = "color",  type = "lower",outline = T, order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_corr_ASD$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```



### Bivariate correlations, TD Only Q>=4
```{r corrplots-TD SA, include=TRUE, echo=FALSE, warning=FALSE, fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot, TD Only'}


SA_data_q4_TD <- subset(SA_data_q4, SA_data_q4$Dx == "TD")

options(digits = 2)
SES_corr_TD <- rcorr(as.matrix(SA_data_q4_TD[,c("V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "zipIncome","lh_transversetemporal_area", "rh_transversetemporal_area", "lh_superiortemporal_area", "rh_superiortemporal_area", "lh_middletemporal_area", "rh_middletemporal_area", "lh_parsopercularis_area", "rh_parsopercularis_area", "lh_parsorbitalis_area", "rh_parsorbitalis_area", "lh_parstriangularis_area", "rh_parstriangularis_area", "TBV")], use="pairwise.complete.obs"))

#mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/corrPlots/SA", #"SES_varsCorr_ASD_q45.tiff")
#tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
corrplot(SES_corr_TD$r, method = "color",  type = "lower", outline = T, order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_corr_TD$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()

```




### Bivariate correlations, TD Only Q>=3
```{r corrplots-TDQ3 SA, include=TRUE, echo=FALSE, warning=FALSE, fig.show='asis', fig.width=7, fig.asp=1, fig.cap='Bivariate Plot, TD Only'}

rm(SES_corr_TD)

SA_data_q3_TD <- subset(SA_data_q3, SA_data_q3$Dx == "TD")

options(digits = 2)
SES_corr_TD <- rcorr(as.matrix(SA_data_q3_TD[,c("V1.Age", "sexCoded", "MEL_cat", "INR", "SES1", "zipIncome","lh_transversetemporal_area", "rh_transversetemporal_area", "lh_superiortemporal_area", "rh_superiortemporal_area", "lh_middletemporal_area", "rh_middletemporal_area", "lh_parsopercularis_area", "rh_parsopercularis_area", "lh_parsorbitalis_area", "rh_parsorbitalis_area", "lh_parstriangularis_area", "rh_parstriangularis_area", "TBV")], use="pairwise.complete.obs"))

#mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/corrPlots/SA", #"SES_varsCorr_ASD_q45.tiff")
#tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
corrplot(SES_corr_TD$r, method = "color",  type = "lower", outline = T, order="original", 
         cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
         p.mat = SES_corr_TD$P, sig.level = 0.05, insig = "blank",
         tl.cex = .75, cl.cex = .75, addCoef.col = "white", number.digits = 2, number.cex = 0.5, 
         col = colorRampPalette(c("midnightblue","white","darkred"))(100))
#dev.off()
```




# SA Results, compare results for data quality Q>=4 vs. data quality Q>=3, Regression Models: INR

```{r, regTables INR Q4 SA, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}


set.seed(1)
rm(outcomes)
# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 15
outcomes <- SA_data_q4[,c(18:31)]
outcomeVars = names(outcomes)



#coVars <- CT_data_q4[,c(4:6, 36)]

#sesVars <- CT_data_q4[,c(37:39, 41:42)]


## MEL Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ SA_data_q4$INR + SA_data_q4$V1.Age +SA_data_q4$TBV)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Income:Needs", "TBV", "Sex"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```

### INR Results, Q>=4 

+ INR Predicts **rh pars orbitalis surface area** controlling for TBV, age, and sex (although neither age nor sex were significant predictors of RH pars orbitalis SA). Dx is also not a significant predictor, and there is no significant Dx by INR interaction. 


```{r, INR Plots and tables Q4 SA, echo = FALSE, include=TRUE, results= 'asis'}

rm(outcomes)

outcomes <- SA_data_q4[,c(18:32)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

rm(lm2)    
lm2 <- lm(rh_parsorbitalis_area ~  INR + TBV + V1.Age + sexCoded, data=SA_data_q4, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "INR", "TBV", "Age", "Sex"),
  dv.labels = paste(outcomeVars[[13]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(SA_data_q4, aes(x=INR, y=rh_parsorbitalis_area, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('RH Pars Orbitalis SA') +
    xlab('Income:Needs Ratio') +
    theme_classic()
    

```






```{r, regTablesQ3 SA INR, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}


rm(outcomes)
set.seed(1)

# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 14
outcomes <- SA_data_q3[,c(18:31)]
outcomeVars = names(outcomes)

#coVars <- CT_data_q4[,c(4:6, 36)]
#sesVars <- CT_data_q4[,c(37:39, 41:42)]


## MEL Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ SA_data_q3$INR + SA_data_q3$sexCoded +SA_data_q3$V1.Age +SA_data_q3$TBV)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
    cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Zip-Income", "Age", "Sex"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```



### INR Results, Q>=3 

* INR Predicts **rh pars orbitalis surface area** controlling for TBV, age, and sex (although neither age nor sex were significant predictors of RH pars orbitalis SA). 



```{r, INR Plots and tables Q3 SA, echo = FALSE, include=TRUE, results= 'asis'}

rm(outcomes)

outcomes <- SA_data_q3[,c(18:32)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

rm(lm2)    
lm2 <- lm(rh_parsorbitalis_area ~  INR + TBV + V1.Age + sexCoded, data=SA_data_q3, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "INR", "TBV", "Age", "Sex"),
  dv.labels = paste(outcomeVars[[13]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(SA_data_q3, aes(x=INR, y=rh_parsorbitalis_area, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('RH Pars Orbitalis SA') +
    xlab('Income:Needs Ratio') +
    theme_classic()
    

```


# SA Results, compare results for data quality Q>=4 vs. data quality Q>=3, Regression Models: SES1

### SES1 Results, Q>=4

```{r, regTables SES1 Q4 SA, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}


set.seed(1)
rm(outcomes)
# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 14
outcomes <- SA_data_q4[,c(18:31)]
outcomeVars = names(outcomes)



#coVars <- CT_data_q4[,c(4:6, 36)]

#sesVars <- CT_data_q4[,c(37:39, 41:42)]


## MEL Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ SA_data_q4$SES1 + SA_data_q4$V1.Age + SA_data_q4$TBV)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Income:Needs", "TBV", "Sex"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```


+ Neighborhood advantage is associated with **left hemisphere pars orbitalis and pars opercularis SA,** controlling for TBV and age.


```{r, SES1 Plots and tables Q4 SA, echo = FALSE, include=TRUE, results= 'asis'}

rm(outcomes)

outcomes <- SA_data_q4[,c(18:31)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

rm(lm2)    
lm2 <- lm(lh_parsorbitalis_area ~  SES1 + TBV + V1.Age, data=SA_data_q4, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "SES1", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[5]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(SA_data_q4, aes(x=SES1, y=lh_parsorbitalis_area, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Pars Orbitalis SA') +
    xlab('Neighborhood Advantage') +
    theme_classic()
    
    cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
    
    rm(lm2)    
lm2 <- lm(lh_parsopercularis_area ~  SES1 + TBV + V1.Age, data=SA_data_q4, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "SES1", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[4]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(SA_data_q4, aes(x=SES1, y=lh_parsopercularis_area, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Pars Opercularis SA') +
    xlab('Neighborhood Advantage') +
    theme_classic()
    

```



### SES1 Results, Q>=3


```{r, regTables SES1 Q3 SA, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}


set.seed(1)
rm(outcomes)
# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 14
outcomes <- SA_data_q3[,c(18:31)]
outcomeVars = names(outcomes)



#coVars <- CT_data_q4[,c(4:6, 36)]

#sesVars <- CT_data_q4[,c(37:39, 41:42)]


## MEL Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ SA_data_q3$SES1 + SA_data_q3$V1.Age + SA_data_q3$TBV)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Income:Needs", "TBV", "Sex"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```

+ Neighborhood advantage associated with **left hemisphere pars opercularis and pars orbitalis SA, as in the Q>=4 dataset, as well as right hemisphere pars triangularis SA (not significant in the Q>=4 dataset**


```{r, SES1 Plots and tables Q3 SA, echo = FALSE, include=TRUE, results= 'asis'}

rm(outcomes)

outcomes <- SA_data_q3[,c(18:31)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

rm(lm2)    
lm2 <- lm(lh_parsorbitalis_area ~  SES1 + TBV + V1.Age, data=SA_data_q3, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "SES1", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[5]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(SA_data_q3, aes(x=SES1, y=lh_parsorbitalis_area, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Pars Orbitalis SA') +
    xlab('Neighborhood Advantage') +
    theme_classic()
    
    cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
    
    rm(lm2)    
lm2 <- lm(lh_parsopercularis_area ~  SES1 + TBV + V1.Age, data=SA_data_q3, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "SES1", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[4]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(SA_data_q3, aes(x=SES1, y=lh_parsopercularis_area, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Pars Opercularis SA') +
    xlab('Neighborhood Advantage') +
    theme_classic()
    
    
        rm(lm2)    
lm2 <- lm(rh_parstriangularis_area ~  SES1 + TBV + V1.Age, data=SA_data_q3, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "SES1", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[14]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(SA_data_q3, aes(x=SES1, y=rh_parstriangularis_area, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('RH Pars Triangularis SA') +
    xlab('Neighborhood Advantage') +
    theme_classic()
    

```


# SA Results, compare results for data quality Q>=4 vs. data quality Q>=3, Regression Models: MEL

### MEL Results, Q>=4

```{r, regTables MEL Q4 SA, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}


set.seed(1)
rm(outcomes)
# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 14
outcomes <- SA_data_q4[,c(18:31)]
outcomeVars = names(outcomes)



#coVars <- CT_data_q4[,c(4:6, 36)]

#sesVars <- CT_data_q4[,c(37:39, 41:42)]


## MEL Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ SA_data_q4$MEL_cat + SA_data_q4$V1.Age + SA_data_q4$TBV)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Income:Needs", "TBV", "Sex"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```


+ Maternal educational level is not associated with surface area in language regions. 



### MEL Results, Q>=3


```{r, regTables MEL Q3 SA, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}


set.seed(1)
rm(outcomes)
# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 14
outcomes <- SA_data_q3[,c(18:31)]
outcomeVars = names(outcomes)



#coVars <- CT_data_q4[,c(4:6, 36)]

#sesVars <- CT_data_q4[,c(37:39, 41:42)]


## MEL Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ SA_data_q3$MEL_cat + SA_data_q3$V1.Age + SA_data_q3$TBV)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Income:Needs", "TBV", "Sex"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```

+ Maternal educational level is not associated with surface area in language regions. 


# SA Results, compare results for data quality Q>=4 vs. data quality Q>=3, Regression Models: Zip-Income


### Zip-Income Results, Q>=4
```{r, regTables ZipIncome Q4 SA, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}


set.seed(1)
rm(outcomes)
# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 14
outcomes <- SA_data_q4[,c(18:31)]
outcomeVars = names(outcomes)



#coVars <- CT_data_q4[,c(4:6, 36)]

#sesVars <- CT_data_q4[,c(37:39, 41:42)]


## MEL Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ SA_data_q4$zipIncome + SA_data_q4$V1.Age + SA_data_q4$TBV)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Income:Needs", "TBV", "Sex"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```

+ Zip-Income is negatively associated with **lh pars orbitalis SA** in the Q>=4 dataset. 


```{r, ZipIncome Plots and tables Q4 SA, echo = FALSE, include=TRUE, results= 'asis'}

rm(outcomes)

outcomes <- SA_data_q4[,c(18:31)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

rm(lm2)    
lm2 <- lm(lh_parsorbitalis_area ~  zipIncome + TBV + V1.Age, data=SA_data_q4, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "SES1", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[5]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(SA_data_q4, aes(x=zipIncome, y=lh_parsorbitalis_area, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Pars Orbitalis SA') +
    xlab('Median Income (Postal Code)') +
    theme_classic()
    

    

```


### Zip-Income Results, Q>=4
```{r, regTables ZipIncome Q3 SA, echo = FALSE, include=FALSE, eval = FALSE, results= 'asis'}


set.seed(1)
rm(outcomes)
# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 14
outcomes <- SA_data_q3[,c(18:31)]
outcomeVars = names(outcomes)



#coVars <- CT_data_q4[,c(4:6, 36)]

#sesVars <- CT_data_q4[,c(37:39, 41:42)]


## MEL Models
# run n regressions
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ SA_data_q3$zipIncome + SA_data_q3$V1.Age + SA_data_q3$TBV)) # change the predictors manually

# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
# ...coefficents with p values:
#sapply(summaries, function(x) x$coefficients[, c(1,4)], simplify = FALSE, USE.NAMES = TRUE)
# ...or r-squared values
#sapply(summaries, function(x) c(r_sq = x$r.squared, adj_r_sq = x$adj.r.squared))


  for (i in seq_along(outcomeVars)) {
   # cat('Linear regression results predicting', outcomeVars[[i]], '\n') 
    cat(tab_model(my_lms[i], pred.labels = c("Intercept", "Income:Needs", "TBV", "Sex"),
  dv.labels = paste(outcomeVars[[i]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")
    
  }


```

+ Zip-Income is negatively associated with **rh pars traingularis SA** in the Q>=3 dataset. 


```{r, ZipIncome Plots and tables Q3 SA, echo = FALSE, include=TRUE, results= 'asis'}

rm(outcomes)

outcomes <- SA_data_q3[,c(18:31)]
outcomeVars = names(outcomes)

cat("\n")
cat("\n")
cat("\n")
cat("\n")

rm(lm2)    
lm2 <- lm(lh_parstriangularis_area ~  zipIncome + TBV + V1.Age, data=SA_data_q3, na.action = na.exclude)   
cat(tab_model(lm2, pred.labels = c("Intercept", "SES1", "TBV", "Age"),
  dv.labels = paste(outcomeVars[[14]]),
  string.pred = "Coeffcient",
  string.ci = "CI (95%)",
  string.p = "p-Value")$knitr,"\n--------\n")


cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")
cat("\n")

    ggplot(SA_data_q3, aes(x=zipIncome, y=rh_parstriangularis_area, color=Dx, shape=Dx)) +
    geom_point() +
    geom_smooth(method=lm, aes(fill=Dx)) +
    scale_color_manual(values=c("red","blue")) +
    scale_fill_manual(values=c("red","blue")) +
    ylab('LH Pars Orbitalis SA') +
    xlab('Median Income (Postal Code)') +
    theme_classic()
    

    

```
