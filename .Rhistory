xlim=c(-5,5))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "SES1_ASD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_ASD$SES1,
geom="histogram",
binwidth =  1,
main = "Histogram for Neighborhood Advantage: ASD",
xlab = "Neighborhood Advantage",
fill=I("red"),
col=I("black"),
xlim=c(-5,5))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "SES1_INR_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_ASD$INR,
geom="histogram",
binwidth =  1,
main = "Histogram for Neighborhood Advantage: ASD",
xlab = "Income:Needs Ratio",
fill=I("red"),
col=I("black"))
#xlim=c(-5,5))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "SES1_TD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_TD$SES1,
geom="histogram",
binwidth = 1,
main = "Histogram for Neighborhood Advantage: TD",
xlab = "Neighborhood Advantage",
fill=I("blue"),
col=I("black"),
xlim=c(-5,5))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "SES1_INR_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_ASD$INR,
geom="histogram",
binwidth =  1,
main = "Histogram for Income-to-Needs Ratio: ASD",
xlab = "Income:Needs Ratio",
fill=I("red"),
col=I("black"),
xlim=c(-1,11))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "INR_TD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_TD$SES1,
geom="histogram",
binwidth = 1,
main = "Histogram for Neighborhood Advantage: TD",
xlab = "Income:Needs Ratio",
fill=I("blue"),
col=I("black")),
xlim=c(-1,11))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "INR_TD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_TD$SES1,
geom="histogram",
binwidth = 1,
main = "Histogram for Neighborhood Advantage: TD",
xlab = "Income:Needs Ratio",
fill=I("blue"),
col=I("black"),
xlim=c(-1,11))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "INR_TD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_TD$SES1,
geom="histogram",
binwidth = 1,
main = "Histogram for Income-to-Needs Ratio: TD",
xlab = "Income:Needs Ratio",
fill=I("blue"),
col=I("black"),
xlim=c(-1,11))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "INR_TD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_TD$INR,
geom="histogram",
binwidth = 1,
main = "Histogram for Income-to-Needs Ratio: TD",
xlab = "Income:Needs Ratio",
fill=I("blue"),
col=I("black"),
xlim=c(-1,11))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "SES1_ASD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_ASD$SES1,
geom="histogram",
binwidth =  1,
main = "Histogram for Neighborhood Advantage: ASD",
xlab = "Neighborhood Advantage",
fill=I("red"),
col=I("black"),
ylim = c(0,9),
xlim=c(-5,5))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "SES1_TD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_TD$SES1,
geom="histogram",
binwidth = 1,
main = "Histogram for Neighborhood Advantage: TD",
xlab = "Neighborhood Advantage",
fill=I("blue"),
col=I("black"),
ylim = c(0,9),
xlim=c(-5,5))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "SES1_INR_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_ASD$INR,
geom="histogram",
binwidth =  1,
main = "Histogram for Income-to-Needs Ratio: ASD",
xlab = "Income:Needs Ratio",
fill=I("red"),
col=I("black"),
ylim = c(0,9),
xlim=c(-1,11))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "INR_TD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_TD$INR,
geom="histogram",
binwidth = 1,
main = "Histogram for Income-to-Needs Ratio: TD",
xlab = "Income:Needs Ratio",
fill=I("blue"),
col=I("black"),
ylim = c(0,9),
xlim=c(-1,11))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "MEL_ASD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_ASD$MEL_cat,
geom="histogram",
binwidth =  1,
main = "Histogram for MEL: ASD",
xlab = "Maternal Educational Level",
fill=I("red"),
col=I("black"),
ylim = c(0,9),
xlim=c(0,8))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "MEL_TD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_TD$MEL_cat,
geom="histogram",
binwidth = 1,
main = "Histogram for MEL: TD",
xlab = "Maternal Educational Level",
fill=I("blue"),
col=I("black"),
ylim = c(0,9),
xlim=c(0,8))
dev.off()
anat_data_TD$MEL_cat
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "MEL_ASD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_ASD$MEL_cat,
geom="histogram",
binwidth =  1,
main = "Histogram for MEL: ASD",
xlab = "Maternal Educational Level",
fill=I("red"),
col=I("black"),
#ylim = c(0,9),
xlim=c(0,8))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "MEL_TD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_TD$MEL_cat,
geom="histogram",
binwidth = 1,
main = "Histogram for MEL: TD",
xlab = "Maternal Educational Level",
fill=I("blue"),
col=I("black"),
#ylim = c(0,9),
xlim=c(0,8))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "MEL_ASD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_ASD$MEL_cat,
geom="histogram",
binwidth =  1,
main = "Histogram for MEL: ASD",
xlab = "Maternal Educational Level",
fill=I("red"),
col=I("black"),
ylim = c(0,13),
xlim=c(0,8))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "MEL_TD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_TD$MEL_cat,
geom="histogram",
binwidth = 1,
main = "Histogram for MEL: TD",
xlab = "Maternal Educational Level",
fill=I("blue"),
col=I("black"),
ylim = c(0,13),
xlim=c(0,8))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "zipIncome_ASD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_ASD$zipIncome,
geom="histogram",
binwidth =  10,000,
main = "Histogram for Zip-Income: ASD",
xlab = "Median Income (Postal Code)",
fill=I("red"),
col=I("black"))
#ylim = c(0,13),
#xlim=c(0,8))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "ZipIncome_TD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_TD$zipIncome,
geom="histogram",
binwidth = 10,000,
main = "Histogram for Zip-Income: TD",
xlab = "Median Income (Postal Code)",
fill=I("blue"),
col=I("black"))
# ylim = c(0,13),
#xlim=c(0,8))
dev.off()
anat_data_TD$zipIncome
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "ZipIncome_TD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_TD$zipIncome,
geom="histogram",
binwidth = 10,000,
main = "Histogram for Zip-Income: TD",
xlab = "Median Income (Postal Code)",
fill=I("blue"),
col=I("black"),
# ylim = c(0,13),
xlim=c(20000,100000))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "ZipIncome_TD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_TD$zipIncome,
geom="histogram",
# binwidth = 10,000,
main = "Histogram for Zip-Income: TD",
xlab = "Median Income (Postal Code)",
fill=I("blue"),
col=I("black"),
# ylim = c(0,13),
xlim=c(20000,100000))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "ZipIncome_TD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_TD$zipIncome,
geom="histogram",
binwidth = 500,
main = "Histogram for Zip-Income: TD",
xlab = "Median Income (Postal Code)",
fill=I("blue"),
col=I("black"),
# ylim = c(0,13),
xlim=c(20000,100000))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "ZipIncome_TD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_TD$zipIncome,
geom="histogram",
binwidth = 15,
main = "Histogram for Zip-Income: TD",
xlab = "Median Income (Postal Code)",
fill=I("blue"),
col=I("black"),
# ylim = c(0,13),
xlim=c(20000,100000))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "ZipIncome_TD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_TD$zipIncome,
geom="histogram",
binwidth = 1000,
main = "Histogram for Zip-Income: TD",
xlab = "Median Income (Postal Code)",
fill=I("blue"),
col=I("black"),
# ylim = c(0,13),
xlim=c(20000,100000))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "ZipIncome_TD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_TD$zipIncome,
geom="histogram",
binwidth = 5000,
main = "Histogram for Zip-Income: TD",
xlab = "Median Income (Postal Code)",
fill=I("blue"),
col=I("black"),
# ylim = c(0,13),
xlim=c(20000,100000))
dev.off()
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/histograms", "zipIncome_ASD_hist.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
qplot(anat_data_ASD$zipIncome,
geom="histogram",
binwidth =  5000,
main = "Histogram for Zip-Income: ASD",
xlab = "Median Income (Postal Code)",
fill=I("red"),
col=I("black"),
#ylim = c(0,13),
xlim=c(20000,100000))
dev.off()
anat_data_ASD$sexCoded
anat_data_ASD$SEX
anat_data_TD$SEX
rm(list=ls()) ## clear the workspace
dev.off() ## Clear the plots
anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/SA_SES.csv')
## Recode some Vars
anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)
set.seed(1)
# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 16
outcomes <- anat_data[,c(17:32)]
outcomeVars = names(outcomes)
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ anat_data$SES1 + anat_data$TBV + anat_data$V1.Age))
# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
outcomeVars
summaries[13]
summaries
outcomeVars[15]
outcomeVars[6]
rm(list=ls()) ## clear the workspace
dev.off() ## Clear the plots
anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/SA_SES.csv')
## Recode some Vars
anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)
set.seed(1)
# number of columns in the Lung and Blood data.frames. 22,000 for you?
n <- 16
outcomes <- anat_data[,c(17:32)]
outcomeVars = names(outcomes)
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ anat_data$SES1+ anat_data$TBV + anat_data$V1.Age))
# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
outcomeVars[13]
summaries[13]
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ anat_data$MEL_cat+ anat_data$TBV + anat_data$V1.Age))
# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
summaries
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ anat_data$INR+ anat_data$TBV + anat_data$V1.Age))
# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
summaries
outcomeVars[14]
my_lms <- lapply(1:n, function(x) lm(outcomes[,x] ~ anat_data$zipIncome+ anat_data$TBV + anat_data$V1.Age))
# if you need more info, get full summary call. now you can get whatever, like:
summaries <- lapply(my_lms, summary)
summaries
outcomeVars[15]
outcomeVars[1]
i = 15
thisOutcome = outcomeVars[i]
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/scatterPlots/SA",paste("zipIncomeby", outcomeVars[i], ".tiff", sep = ""))
tiff(file=mypath,width = 6, height = 6, units = 'in', res = 300)
ggplot(anat_data, aes(x=zipIncome, y=as.matrix(outcomes[i]), color=Dx, shape=Dx)) +
geom_point() +
geom_smooth(method=lm, aes(fill=Dx)) +
scale_color_manual(values=c("red","blue")) +
scale_fill_manual(values=c("red","blue")) +
ylab(thisOutcome) +
xlab('Median Income (Postal Code)') +
theme_classic()
dev.off()
summaries[15]
i = 1
thisOutcome = outcomeVars[i]
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/scatterPlots/SA",paste("SES2by", outcomeVars[i], ".tiff", sep = ""))
tiff(file=mypath,width = 6, height = 6, units = 'in', res = 300)
ggplot(anat_data, aes(x=SES2, y=as.matrix(outcomes[i]), color=Dx, shape=Dx)) +
geom_point() +
geom_smooth(method=lm, aes(fill=Dx)) +
scale_color_manual(values=c("red","blue")) +
scale_fill_manual(values=c("red","blue")) +
ylab(thisOutcome) +
xlab('Neighborhood Disadvantage') +
theme_classic()
dev.off()
}
thisOutcome = outcomeVars[i]
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/scatterPlots/SA",paste("SES2by", outcomeVars[i], ".tiff", sep = ""))
tiff(file=mypath,width = 6, height = 6, units = 'in', res = 300)
ggplot(anat_data, aes(x=SES2, y=as.matrix(outcomes[i]), color=Dx, shape=Dx)) +
geom_point() +
geom_smooth(method=lm, aes(fill=Dx)) +
scale_color_manual(values=c("red","blue")) +
scale_fill_manual(values=c("red","blue")) +
ylab(thisOutcome) +
xlab('Neighborhood Disadvantage') +
theme_classic()
dev.off()
thisOutcome = outcomeVars[i]
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/scatterPlots/SA",paste("zipIncomeby", outcomeVars[i], ".tiff", sep = ""))
tiff(file=mypath,width = 6, height = 6, units = 'in', res = 300)
ggplot(anat_data, aes(x=zipIncome, y=as.matrix(outcomes[i]), color=Dx, shape=Dx)) +
geom_point() +
geom_smooth(method=lm, aes(fill=Dx)) +
scale_color_manual(values=c("red","blue")) +
scale_fill_manual(values=c("red","blue")) +
ylab(thisOutcome) +
xlab('Median Income (Postal Code)') +
theme_classic()
dev.off()
names(anat_data)
rm(list=ls()) ## clear the workspace
anat_data = read.csv('/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/SES_Anat_v2_q45.csv')
library(plyr)
library(ggplot2)
library(tidyverse)
library(knitr)
library(lavaan)
#library(psych)
library(MBESS)
library(magrittr)
library(dplyr)
library(ppcor)
library(data.table)
library(stats)
library(corrplot)
library(Hmisc)
library(ppcor)
library(rmarkdown)
library(knitr)
## Recode some Vars
anat_data$dxCoded <- as.factor(anat_data$Dx) # 1 = ASD, 2 = TD
anat_data$dxCoded <-unclass(anat_data$dxCoded)
anat_data$sexCoded <- as.factor(anat_data$SEX) # 1 = Female, 2 = Male
anat_data$sexCoded <-unclass(anat_data$sexCoded)
SES_Lang_LGI <- rcorr(as.matrix(anat_data[,c("dxCoded", "MEL_cat", "INR", "SES1", "SES2", "zipIncome","lh_transversetemporal_lgi", "rh_transversetemporal_lgi", "lh_superiortemporal_lgi", "rh_superiortemporal_lgi", "lh_middletemporal_lgi", "rh_middletemporal_lgi", "lh_parsopercularis_lgi", "rh_parsopercularis_lgi", "lh_parsorbitalis_lgi", "rh_parsorbitalis_lgi", "lh_parstriangularis_lgi", "rh_parstriangularis_lgi", "TBV")], use="pairwise.complete.obs"))
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/corrPlots/LGI", "SES_LGI_varsCorr_q45.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
corrplot(SES_Lang_LGI$r, method = "color",  type = "lower", outline = T, addgrid.col = "darkgray", order="original",
cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
p.mat = SES_Lang_LGI$P, sig.level = 0.05, insig = "blank",
tl.cex = 1.5, cl.cex = 1.5, addCoef.col = "white", number.digits = 2, number.cex = 0.75,
col = colorRampPalette(c("midnightblue","white","darkred"))(100))
dev.off()
anat_data_ASD <- subset(anat_data, anat_data$Dx == "ASD")
options(digits = 2)
SES_corr_ASD <- rcorr(as.matrix(anat_data_ASD[,c("MEL_cat", "INR", "SES1", "SES2", "zipIncome","lh_transversetemporal_lgi", "rh_transversetemporal_lgi", "lh_superiortemporal_lgi", "rh_superiortemporal_lgi", "lh_middletemporal_lgi", "rh_middletemporal_lgi", "lh_parsopercularis_lgi", "rh_parsopercularis_lgi", "lh_parsorbitalis_lgi", "rh_parsorbitalis_lgi", "lh_parstriangularis_lgi", "rh_parstriangularis_lgi", "TBV")], use="pairwise.complete.obs"))
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/corrPlots/LGI", "SES_varsCorr_ASD_q45.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
corrplot(SES_corr_ASD$r, method = "color",  type = "lower", outline = T, addgrid.col = "darkgray", order="original",
cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
p.mat = SES_corr_ASD$P, sig.level = 0.05, insig = "blank",
tl.cex = 1.5, cl.cex = 1.5, addCoef.col = "white", number.digits = 2, number.cex = 0.75,
col = colorRampPalette(c("midnightblue","white","darkred"))(100))
dev.off()
anat_data_TD <- subset(anat_data, anat_data$Dx == "TD")
SES_corr_TD <- rcorr(as.matrix(anat_data_TD[,c("MEL_cat", "INR", "SES1", "SES2", "zipIncome","lh_transversetemporal_lgi", "rh_transversetemporal_lgi", "lh_superiortemporal_lgi", "rh_superiortemporal_lgi", "lh_middletemporal_lgi", "rh_middletemporal_lgi", "lh_parsopercularis_lgi", "rh_parsopercularis_lgi", "lh_parsorbitalis_lgi", "rh_parsorbitalis_lgi", "lh_parstriangularis_lgi", "rh_parstriangularis_lgi", "TBV")], use="pairwise.complete.obs"))
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/corrPlots/LGI", "SES_varsCorr_TD_q45.tiff")
tiff(file=mypath,width = 10, height = 10, units = 'in', res = 300)
corrplot(SES_corr_TD$r, method = "color",  type = "lower", outline = T, addgrid.col = "darkgray", order="original",
cl.pos = "b", tl.col = "indianred4", tl.srt = 45,
p.mat = SES_corr_TD$P, sig.level = 0.05, insig = "blank",
tl.cex = 1.5, cl.cex = 1.5, addCoef.col = "white", number.digits = 2, number.cex = 0.75,
col = colorRampPalette(c("midnightblue","white","darkred"))(100))
dev.off()
model_lhSupTemp_INR <- lm(lh_superiortemporal_lgi ~  INR  + zipIncome + TBV, data=anat_data, na.action = na.exclude)
summary(model_lhSupTemp_INR)
modelLH_STG_residTBV <- lm(lh_superiortemporal_lgi ~  TBV + zipIncome, data=anat_data, na.action = na.exclude)
LH_STG_residTBV_zipIncome <- resid(modelLH_STG_residTBV)
# INR, given Dx, ZipIncome, MEL
modelINR_residTBV <- lm(INR ~  TBV + zipIncome, data=anat_data, na.action = na.exclude)
INR_resid_TBV_zipIncome <- resid(modelINR_residTBV)
mypath <- file.path("/Users/lolson/Documents/001_JDP/001_BDIL/006_Projects/11_ToddlerSES/todanatomicaldata/scatterPlots/LGI", "lh_STG_LGI_ASDvTD_partialReg_q45.tiff")
tiff(file=mypath,width = 6, height = 6, units = 'in', res = 300)
ggplot(anat_data, aes(x=INR_resid_TBV_zipIncome, y=LH_STG_residTBV_zipIncome, color=Dx, shape=Dx)) +
geom_point() +
geom_smooth(method=lm, aes(fill=Dx)) +
scale_color_manual(values=c("red","blue")) +
scale_fill_manual(values=c("red","blue")) +
ylab('Left STG LGI')+
xlab('Income:Needs Ratio') +
labs(title="Income:Needs by Left STG LGI") +
theme_classic()+
theme(plot.title = element_text(hjust = 0.5))
dev.off()
INR_resid_TBV_zipIncome
modelINR_residTBV <- lm(INR ~  TBV + zipIncome, data=anat_data, na.action = na.exclude)
rm(INR_resid_TBV_zipIncome)
INR_resid_TBV_zipIncome <- resid(modelINR_residTBV)
INR_resid_TBV_zipIncome
modelINR_residTBV
summary(modelINR_residTBV)
resid(modelINR_residTBV)
